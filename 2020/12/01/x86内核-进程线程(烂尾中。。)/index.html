<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>x86内核-进程线程(烂尾中。。) | ZDDR's blog</title><meta name="keywords" content="ZDDR,逆向,内核,Pwn"><meta name="author" content="ZDDR"><meta name="copyright" content="ZDDR"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="什么是进程进程本质上就是一块被特殊标识的内存区域 进程的结构由于Windows不是宏内核，所以结构被分成了两部分：执行体、微内核。 执行体结构123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869">
<meta property="og:type" content="article">
<meta property="og:title" content="x86内核-进程线程(烂尾中。。)">
<meta property="og:url" content="https://zddr.net/2020/12/01/x86%E5%86%85%E6%A0%B8-%E8%BF%9B%E7%A8%8B%E7%BA%BF%E7%A8%8B(%E7%83%82%E5%B0%BE%E4%B8%AD%E3%80%82%E3%80%82)/index.html">
<meta property="og:site_name" content="ZDDR&#39;s blog">
<meta property="og:description" content="什么是进程进程本质上就是一块被特殊标识的内存区域 进程的结构由于Windows不是宏内核，所以结构被分成了两部分：执行体、微内核。 执行体结构123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://s2.ax1x.com/2020/02/11/1oFBM8.png">
<meta property="article:published_time" content="2020-11-30T16:00:00.000Z">
<meta property="article:modified_time" content="2020-11-17T16:00:00.000Z">
<meta property="article:author" content="ZDDR">
<meta property="article:tag" content="ZDDR,逆向,内核,Pwn">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s2.ax1x.com/2020/02/11/1oFBM8.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://zddr.net/2020/12/01/x86%E5%86%85%E6%A0%B8-%E8%BF%9B%E7%A8%8B%E7%BA%BF%E7%A8%8B(%E7%83%82%E5%B0%BE%E4%B8%AD%E3%80%82%E3%80%82)/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: ZDDR","link":"链接: ","source":"来源: ZDDR's blog","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
};

var saveToLocal = {
  set: function setWithExpiry(key, value, ttl) {
    const now = new Date()
    const expiryDay = ttl * 86400000
    const item = {
      value: value,
      expiry: now.getTime() + expiryDay,
    }
    localStorage.setItem(key, JSON.stringify(item))
  },

  get: function getWithExpiry(key) {
    const itemStr = localStorage.getItem(key)

    if (!itemStr) {
      return undefined
    }
    const item = JSON.parse(itemStr)
    const now = new Date()

    if (now.getTime() > item.expiry) {
      localStorage.removeItem(key)
      return undefined
    }
    return item.value
  }
}

// https://stackoverflow.com/questions/16839698/jquery-getscript-alternative-in-native-javascript
const getScript = url => new Promise((resolve, reject) => {
  const script = document.createElement('script')
  script.src = url
  script.async = true
  script.onerror = reject
  script.onload = script.onreadystatechange = function() {
    const loadState = this.readyState
    if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
    script.onload = script.onreadystatechange = null
    resolve()
  }
  document.head.appendChild(script)
})</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2020-11-18 00:00:00'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(function () {  window.activateDarkMode = function () {
    document.documentElement.setAttribute('data-theme', 'dark')
    if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
    }
  }
  window.activateLightMode = function () {
    document.documentElement.setAttribute('data-theme', 'light')
   if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
    }
  }
  const autoChangeMode = 'false'
  const t = saveToLocal.get('theme')
  if (autoChangeMode === '1') {
    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified
    if (t === undefined) {
      if (isLightMode) activateLightMode()
      else if (isDarkMode) activateDarkMode()
      else if (isNotSpecified || hasNoSupport) {
        const now = new Date()
        const hour = now.getHours()
        const isNight = hour <= 6 || hour >= 18
        isNight ? activateDarkMode() : activateLightMode()
      }
      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
        if (saveToLocal.get('theme') === undefined) {
          e.matches ? activateDarkMode() : activateLightMode()
        }
      })
    } else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else if (autoChangeMode === '2') {
    const now = new Date()
    const hour = now.getHours()
    const isNight = hour <= 6 || hour >= 18
    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
    else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else {
    if (t === 'dark') activateDarkMode()
    else if (t === 'light') activateLightMode()
  }const asideStatus = saveToLocal.get('aside-status')
if (asideStatus !== undefined) {
   if (asideStatus === 'hide') {
     document.documentElement.classList.add('hide-aside')
   } else {
     document.documentElement.classList.remove('hide-aside')
   }
}})()</script><meta name="generator" content="Hexo 5.3.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="https://gitee.com/ZDDR/blog_img/raw/master/img/index_img/%E8%87%AA%E5%B7%B1%E7%9A%84%E5%A4%B4%E5%83%8F.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">18</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">8</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://s2.ax1x.com/2020/02/11/1oFBM8.png)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">ZDDR's blog</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">x86内核-进程线程(烂尾中。。)</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-11-30T16:00:00.000Z" title="发表于 2020-12-01 00:00:00">2020-12-01</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2020-11-17T16:00:00.000Z" title="更新于 2020-11-18 00:00:00">2020-11-18</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/windows%E5%86%85%E6%A0%B8/">windows内核</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="什么是进程"><a href="#什么是进程" class="headerlink" title="什么是进程"></a>什么是进程</h1><p>进程本质上就是一块被特殊标识的内存区域</p>
<h2 id="进程的结构"><a href="#进程的结构" class="headerlink" title="进程的结构"></a>进程的结构</h2><p>由于Windows不是宏内核，所以结构被分成了两部分：执行体、微内核。</p>
<h3 id="执行体结构"><a href="#执行体结构" class="headerlink" title="执行体结构"></a>执行体结构</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>: kd&gt; dt _EPROCESS</span><br><span class="line">ntdll!_EPROCESS</span><br><span class="line">   +<span class="number">0x000</span> Pcb              : _KPROCESS					<span class="comment">//微内核</span></span><br><span class="line">   +<span class="number">0x098</span> ProcessLock      : _EX_PUSH_LOCK				<span class="comment">//EPROCESS进程锁</span></span><br><span class="line">   +<span class="number">0x0a0</span> CreateTime       : _LARGE_INTEGER				<span class="comment">//进程创建的时间</span></span><br><span class="line">   +<span class="number">0x0a8</span> ExitTime         : _LARGE_INTEGER				<span class="comment">//进程结束时间</span></span><br><span class="line">   +<span class="number">0x0b0</span> RundownProtect   : _EX_RUNDOWN_REF			<span class="comment">//锁</span></span><br><span class="line">   +<span class="number">0x0b4</span> UniqueProcessId  : Ptr32 Void					<span class="comment">//进程pid</span></span><br><span class="line">   +<span class="number">0x0b8</span> ActiveProcessLinks : _LIST_ENTRY				<span class="comment">//进程链表 所有可见进程</span></span><br><span class="line">   +<span class="number">0x0c0</span> ProcessQuotaUsage : [<span class="number">2</span>] Uint4B				<span class="comment">//性能分析</span></span><br><span class="line">   +<span class="number">0x0c8</span> ProcessQuotaPeak : [<span class="number">2</span>] Uint4B					</span><br><span class="line">   +<span class="number">0x0d0</span> CommitCharge     : Uint4B						</span><br><span class="line">   +<span class="number">0x0d4</span> QuotaBlock       : Ptr32 _EPROCESS_QUOTA_BLOCK</span><br><span class="line">   +<span class="number">0x0d8</span> CpuQuotaBlock    : Ptr32 _PS_CPU_QUOTA_BLOCK	</span><br><span class="line">   +<span class="number">0x0dc</span> PeakVirtualSize  : Uint4B						</span><br><span class="line">   +<span class="number">0x0e0</span> VirtualSize      : Uint4B</span><br><span class="line">   +<span class="number">0x0e4</span> SessionProcessLinks : _LIST_ENTRY				<span class="comment">//session进程链表</span></span><br><span class="line">   +<span class="number">0x0ec</span> DebugPort        : Ptr32 Void					<span class="comment">//三环调试器附加会在这创建一个debg对象</span></span><br><span class="line">   +<span class="number">0x0f0</span> ExceptionPortData : Ptr32 Void				<span class="comment">//异常数据上报</span></span><br><span class="line">   +<span class="number">0x0f0</span> ExceptionPortValue : Uint4B</span><br><span class="line">   +<span class="number">0x0f0</span> ExceptionPortState : Pos <span class="number">0</span>, <span class="number">3</span> Bits</span><br><span class="line">   +<span class="number">0x0f4</span> ObjectTable      : Ptr32 _HANDLE_TABLE		<span class="comment">//私有句柄表</span></span><br><span class="line">   +<span class="number">0x0f8</span> Token            : _EX_FAST_REF				<span class="comment">//当前权限描述</span></span><br><span class="line">   +<span class="number">0x0fc</span> WorkingSetPage   : Uint4B						<span class="comment">//有多少个页正在工作</span></span><br><span class="line">   +<span class="number">0x100</span> AddressCreationLock : _EX_PUSH_LOCK			<span class="comment">//互斥体</span></span><br><span class="line">   +<span class="number">0x104</span> RotateInProgress : Ptr32 _ETHREAD				</span><br><span class="line">   +<span class="number">0x108</span> ForkInProgress   : Ptr32 _ETHREAD</span><br><span class="line">   +<span class="number">0x10c</span> HardwareTrigger  : Uint4B						<span class="comment">//硬件触发计数</span></span><br><span class="line">   +<span class="number">0x110</span> PhysicalVadRoot  : Ptr32 _MM_AVL_TABLE		<span class="comment">//物理页管理vad</span></span><br><span class="line">   +<span class="number">0x114</span> CloneRoot        : Ptr32 Void					<span class="comment">//克隆</span></span><br><span class="line">   +<span class="number">0x118</span> NumberOfPrivatePages : Uint4B</span><br><span class="line">   +<span class="number">0x11c</span> NumberOfLockedPages : Uint4B</span><br><span class="line">   +<span class="number">0x120</span> Win32Process     : Ptr32 Void					<span class="comment">//是否为ui进程</span></span><br><span class="line">   +<span class="number">0x124</span> Job              : Ptr32 _EJOB				<span class="comment">//job对象</span></span><br><span class="line">   +<span class="number">0x128</span> SectionObject    : Ptr32 Void					<span class="comment">//节区obj</span></span><br><span class="line">   +<span class="number">0x12c</span> SectionBaseAddress : Ptr32 Void				<span class="comment">//exeImageBase</span></span><br><span class="line">   +<span class="number">0x130</span> Cookie           : Uint4B						<span class="comment">//指针加解密异或此值</span></span><br><span class="line">   +<span class="number">0x134</span> Spare8           : Uint4B</span><br><span class="line">   +<span class="number">0x138</span> WorkingSetWatch  : Ptr32 _PAGEFAULT_HISTORY	<span class="comment">//检测别人读</span></span><br><span class="line">   +<span class="number">0x13c</span> Win32WindowStation : Ptr32 Void</span><br><span class="line">   +<span class="number">0x140</span> InheritedFromUniqueProcessId : Ptr32 Void		<span class="comment">//这个进程是谁创建的（父id）</span></span><br><span class="line">   +<span class="number">0x144</span> LdtInformation   : Ptr32 Void					<span class="comment">//ldt</span></span><br><span class="line">   +<span class="number">0x148</span> VdmObjects       : Ptr32 Void					<span class="comment">//虚拟8086模式的对象</span></span><br><span class="line">   +<span class="number">0x14c</span> ConsoleHostProcess : Uint4B					<span class="comment">//控制台句柄</span></span><br><span class="line">   +<span class="number">0x150</span> DeviceMap        : Ptr32 Void					</span><br><span class="line">   +<span class="number">0x154</span> EtwDataSource    : Ptr32 Void					<span class="comment">//etw数据</span></span><br><span class="line">   +<span class="number">0x158</span> FreeTebHint      : Ptr32 Void					</span><br><span class="line">   +<span class="number">0x160</span> PageDirectoryPte : _HARDWARE_PTE_X86</span><br><span class="line">   +<span class="number">0x160</span> Filler           : Uint8B</span><br><span class="line">   +<span class="number">0x168</span> Session          : Ptr32 Void					<span class="comment">//Session 会话对象</span></span><br><span class="line">   +<span class="number">0x16c</span> ImageFileName    : [<span class="number">15</span>] UChar					<span class="comment">//进程名字</span></span><br><span class="line">   +<span class="number">0x17b</span> PriorityClass    : UChar						<span class="comment">//优先级</span></span><br><span class="line">   +<span class="number">0x17c</span> JobLinks         : _LIST_ENTRY				<span class="comment">//job链表</span></span><br><span class="line">   +<span class="number">0x184</span> LockedPagesList  : Ptr32 Void					<span class="comment">//锁页链表</span></span><br><span class="line">   +<span class="number">0x188</span> ThreadListHead   : _LIST_ENTRY				<span class="comment">//线程链表</span></span><br><span class="line">   +<span class="number">0x190</span> SecurityPort     : Ptr32 Void					<span class="comment">//安全端口</span></span><br><span class="line">   +<span class="number">0x194</span> PaeTop           : Ptr32 Void					</span><br><span class="line">   +<span class="number">0x198</span> ActiveThreads    : Uint4B						<span class="comment">//进程活动数</span></span><br><span class="line">   +<span class="number">0x19c</span> ImagePathHash    : Uint4B						<span class="comment">//名字路径的hash值</span></span><br><span class="line">   +<span class="number">0x1a0</span> DefaultHardErrorProcessing : Uint4B			</span><br><span class="line">   +<span class="number">0x1a4</span> LastThreadExitStatus : Int4B					</span><br><span class="line">   +<span class="number">0x1a8</span> Peb              : Ptr32 _PEB					</span><br><span class="line">   +<span class="number">0x1ac</span> PrefetchTrace    : _EX_FAST_REF				</span><br><span class="line">   +<span class="number">0x1b0</span> ReadOperationCount : _LARGE_INTEGER			<span class="comment">//进程中如果有操作文件，读写查询统计</span></span><br><span class="line">   +<span class="number">0x1b8</span> WriteOperationCount : _LARGE_INTEGER			</span><br><span class="line">   +<span class="number">0x1c0</span> OtherOperationCount : _LARGE_INTEGER			</span><br><span class="line">   +<span class="number">0x1c8</span> ReadTransferCount : _LARGE_INTEGER			</span><br><span class="line">   +<span class="number">0x1d0</span> WriteTransferCount : _LARGE_INTEGER			</span><br><span class="line">   +<span class="number">0x1d8</span> OtherTransferCount : _LARGE_INTEGER			</span><br><span class="line">   +<span class="number">0x1e0</span> CommitChargeLimit : Uint4B					</span><br><span class="line">   +<span class="number">0x1e4</span> CommitChargePeak : Uint4B						</span><br><span class="line">   +<span class="number">0x1e8</span> AweInfo          : Ptr32 Void					</span><br><span class="line">   +<span class="number">0x1ec</span> SeAuditProcessCreationInfo : _SE_AUDIT_PROCESS_CREATION_INFO <span class="comment">//这也有一个名字</span></span><br><span class="line">   +<span class="number">0x1f0</span> Vm               : _MMSUPPORT					<span class="comment">//工作集</span></span><br><span class="line">   +<span class="number">0x25c</span> MmProcessLinks   : _LIST_ENTRY					</span><br><span class="line">   +<span class="number">0x264</span> HighestUserAddress : Ptr32 Void									</span><br><span class="line">   +<span class="number">0x268</span> ModifiedPageCount : Uint4B										</span><br><span class="line">   +<span class="number">0x26c</span> Flags2           : Uint4B												</span><br><span class="line">   +<span class="number">0x26c</span> JobNotReallyActive : Pos <span class="number">0</span>, <span class="number">1</span> Bit								</span><br><span class="line">   +<span class="number">0x26c</span> AccountingFolded : Pos <span class="number">1</span>, <span class="number">1</span> Bit									</span><br><span class="line">   +<span class="number">0x26c</span> NewProcessReported : Pos <span class="number">2</span>, <span class="number">1</span> Bit								</span><br><span class="line">   +<span class="number">0x26c</span> ExitProcessReported : Pos <span class="number">3</span>, <span class="number">1</span> Bit			<span class="comment">//错误上报							</span></span><br><span class="line">   +<span class="number">0x26c</span> ReportCommitChanges : Pos <span class="number">4</span>, <span class="number">1</span> Bit				</span><br><span class="line">   +<span class="number">0x26c</span> LastReportMemory : Pos <span class="number">5</span>, <span class="number">1</span> Bit				</span><br><span class="line">   +<span class="number">0x26c</span> ReportPhysicalPageChanges : Pos <span class="number">6</span>, <span class="number">1</span> Bit				</span><br><span class="line">   +<span class="number">0x26c</span> HandleTableRundown : Pos <span class="number">7</span>, <span class="number">1</span> Bit				</span><br><span class="line">   +<span class="number">0x26c</span> NeedsHandleRundown : Pos <span class="number">8</span>, <span class="number">1</span> Bit				</span><br><span class="line">   +<span class="number">0x26c</span> RefTraceEnabled  : Pos <span class="number">9</span>, <span class="number">1</span> Bit				</span><br><span class="line">   +<span class="number">0x26c</span> NumaAware        : Pos <span class="number">10</span>, <span class="number">1</span> Bit				</span><br><span class="line">   +<span class="number">0x26c</span> ProtectedProcess : Pos <span class="number">11</span>, <span class="number">1</span> Bit				<span class="comment">//应用层访问保护 防止调试</span></span><br><span class="line">   +<span class="number">0x26c</span> DefaultPagePriority : Pos <span class="number">12</span>, <span class="number">3</span> Bits				</span><br><span class="line">   +<span class="number">0x26c</span> PrimaryTokenFrozen : Pos <span class="number">15</span>, <span class="number">1</span> Bit				</span><br><span class="line">   +<span class="number">0x26c</span> ProcessVerifierTarget : Pos <span class="number">16</span>, <span class="number">1</span> Bit				</span><br><span class="line">   +<span class="number">0x26c</span> StackRandomizationDisabled : Pos <span class="number">17</span>, <span class="number">1</span> Bit				</span><br><span class="line">   +<span class="number">0x26c</span> AffinityPermanent : Pos <span class="number">18</span>, <span class="number">1</span> Bit				</span><br><span class="line">   +<span class="number">0x26c</span> AffinityUpdateEnable : Pos <span class="number">19</span>, <span class="number">1</span> Bit</span><br><span class="line">   +<span class="number">0x26c</span> PropagateNode    : Pos <span class="number">20</span>, <span class="number">1</span> Bit</span><br><span class="line">   +<span class="number">0x26c</span> ExplicitAffinity : Pos <span class="number">21</span>, <span class="number">1</span> Bit</span><br><span class="line">   +<span class="number">0x270</span> Flags            : Uint4B</span><br><span class="line">   +<span class="number">0x270</span> CreateReported   : Pos <span class="number">0</span>, <span class="number">1</span> Bit</span><br><span class="line">   +<span class="number">0x270</span> NoDebugInherit   : Pos <span class="number">1</span>, <span class="number">1</span> Bit</span><br><span class="line">   +<span class="number">0x270</span> ProcessExiting   : Pos <span class="number">2</span>, <span class="number">1</span> Bit <span class="comment">//进程是否正在结束</span></span><br><span class="line">   +<span class="number">0x270</span> ProcessDelete    : Pos <span class="number">3</span>, <span class="number">1</span> Bit</span><br><span class="line">   +<span class="number">0x270</span> Wow64SplitPages  : Pos <span class="number">4</span>, <span class="number">1</span> Bit</span><br><span class="line">   +<span class="number">0x270</span> VmDeleted        : Pos <span class="number">5</span>, <span class="number">1</span> Bit</span><br><span class="line">   +<span class="number">0x270</span> OutswapEnabled   : Pos <span class="number">6</span>, <span class="number">1</span> Bit</span><br><span class="line">   +<span class="number">0x270</span> Outswapped       : Pos <span class="number">7</span>, <span class="number">1</span> Bit</span><br><span class="line">   +<span class="number">0x270</span> ForkFailed       : Pos <span class="number">8</span>, <span class="number">1</span> Bit</span><br><span class="line">   +<span class="number">0x270</span> Wow64VaSpace4Gb  : Pos <span class="number">9</span>, <span class="number">1</span> Bit</span><br><span class="line">   +<span class="number">0x270</span> AddressSpaceInitialized : Pos <span class="number">10</span>, <span class="number">2</span> Bits</span><br><span class="line">   +<span class="number">0x270</span> SetTimerResolution : Pos <span class="number">12</span>, <span class="number">1</span> Bit</span><br><span class="line">   +<span class="number">0x270</span> BreakOnTermination : Pos <span class="number">13</span>, <span class="number">1</span> Bit<span class="comment">//系统进程</span></span><br><span class="line">   +<span class="number">0x270</span> DeprioritizeViews : Pos <span class="number">14</span>, <span class="number">1</span> Bit</span><br><span class="line">   +<span class="number">0x270</span> WriteWatch       : Pos <span class="number">15</span>, <span class="number">1</span> Bit</span><br><span class="line">   +<span class="number">0x270</span> ProcessInSession : Pos <span class="number">16</span>, <span class="number">1</span> Bit</span><br><span class="line">   +<span class="number">0x270</span> OverrideAddressSpace : Pos <span class="number">17</span>, <span class="number">1</span> Bit</span><br><span class="line">   +<span class="number">0x270</span> HasAddressSpace  : Pos <span class="number">18</span>, <span class="number">1</span> Bit</span><br><span class="line">   +<span class="number">0x270</span> LaunchPrefetched : Pos <span class="number">19</span>, <span class="number">1</span> Bit</span><br><span class="line">   +<span class="number">0x270</span> InjectInpageErrors : Pos <span class="number">20</span>, <span class="number">1</span> Bit</span><br><span class="line">   +<span class="number">0x270</span> VmTopDown        : Pos <span class="number">21</span>, <span class="number">1</span> Bit</span><br><span class="line">   +<span class="number">0x270</span> ImageNotifyDone  : Pos <span class="number">22</span>, <span class="number">1</span> Bit</span><br><span class="line">   +<span class="number">0x270</span> PdeUpdateNeeded  : Pos <span class="number">23</span>, <span class="number">1</span> Bit</span><br><span class="line">   +<span class="number">0x270</span> VdmAllowed       : Pos <span class="number">24</span>, <span class="number">1</span> Bit<span class="comment">//地址分配方式 0从小到大 1从大到小</span></span><br><span class="line">   +<span class="number">0x270</span> CrossSessionCreate : Pos <span class="number">25</span>, <span class="number">1</span> Bit</span><br><span class="line">   +<span class="number">0x270</span> ProcessInserted  : Pos <span class="number">26</span>, <span class="number">1</span> Bit<span class="comment">//阻止附加2 任务管理器无法结束</span></span><br><span class="line">   +<span class="number">0x270</span> DefaultIoPriority : Pos <span class="number">27</span>, <span class="number">3</span> Bits</span><br><span class="line">   +<span class="number">0x270</span> ProcessSelfDelete : Pos <span class="number">30</span>, <span class="number">1</span> Bit<span class="comment">//判断进程是不是自己关掉的</span></span><br><span class="line">   +<span class="number">0x270</span> SetTimerResolutionLink : Pos <span class="number">31</span>, <span class="number">1</span> Bit</span><br><span class="line">   +<span class="number">0x274</span> ExitStatus       : Int4B				<span class="comment">//进程退出错误码</span></span><br><span class="line">   +<span class="number">0x278</span> VadRoot          : _MM_AVL_TABLE</span><br><span class="line">   +<span class="number">0x298</span> AlpcContext      : _ALPC_PROCESS_CONTEXT</span><br><span class="line">   +<span class="number">0x2a8</span> TimerResolutionLink : _LIST_ENTRY</span><br><span class="line">   +<span class="number">0x2b0</span> RequestedTimerResolution : Uint4B</span><br><span class="line">   +<span class="number">0x2b4</span> ActiveThreadsHighWatermark : Uint4B</span><br><span class="line">   +<span class="number">0x2b8</span> SmallestTimerResolution : Uint4B</span><br><span class="line">   +<span class="number">0x2bc</span> TimerResolutionStackRecord : Ptr32 _PO_DIAG_STACK_RECORD</span><br></pre></td></tr></table></figure>
<h3 id="微内核结构"><a href="#微内核结构" class="headerlink" title="微内核结构"></a>微内核结构</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>: kd&gt; dt _KPROCESS</span><br><span class="line">ntdll!_KPROCESS</span><br><span class="line">   +<span class="number">0x000</span> Header           : _DISPATCHER_HEADER</span><br><span class="line">   +<span class="number">0x010</span> ProfileListHead  : _LIST_ENTRY			<span class="comment">//性能分析链表（_LIST_ENTRY双向链表）</span></span><br><span class="line">   +<span class="number">0x018</span> DirectoryTableBase : Uint4B				<span class="comment">//进程CR3</span></span><br><span class="line">   +<span class="number">0x01c</span> LdtDescriptor    : _KGDTENTRY				<span class="comment">//LDT描述符</span></span><br><span class="line">   +<span class="number">0x024</span> Int21Descriptor  : _KIDTENTRY				<span class="comment">//虚拟8086的中断描述符</span></span><br><span class="line">   +<span class="number">0x02c</span> ThreadListHead   : _LIST_ENTRY			<span class="comment">//属于此进程的所有线程都会挂在这个链表上</span></span><br><span class="line">   +<span class="number">0x034</span> ProcessLock      : Uint4B					<span class="comment">//进程锁，如要修改KPROCESS内容要先锁住，防止同时修改</span></span><br><span class="line">   +<span class="number">0x038</span> Affinity         : _KAFFINITY_EX			<span class="comment">//亲和性，创建的线程放在哪个核运行</span></span><br><span class="line">   +<span class="number">0x044</span> ReadyListHead    : _LIST_ENTRY			<span class="comment">//就绪链表，当线程就绪，就插到此链表上，等待被调度</span></span><br><span class="line">   +<span class="number">0x04c</span> SwapListEntry    : _SINGLE_LIST_ENTRY		<span class="comment">//记录此线程被交换到磁盘上的数据（_SINGLE_LIST_ENTRY单项链表）</span></span><br><span class="line">   +<span class="number">0x050</span> ActiveProcessors : _KAFFINITY_EX			<span class="comment">//当前用到的哪些核</span></span><br><span class="line">   +<span class="number">0x05c</span> AutoAlignment    : Pos <span class="number">0</span>, <span class="number">1</span> Bit			<span class="comment">//是否自动对齐</span></span><br><span class="line">   +<span class="number">0x05c</span> DisableBoost     : Pos <span class="number">1</span>, <span class="number">1</span> Bit			<span class="comment">//线程优先级</span></span><br><span class="line">   +<span class="number">0x05c</span> DisableQuantum   : Pos <span class="number">2</span>, <span class="number">1</span> Bit			<span class="comment">//关闭时间碎片</span></span><br><span class="line">   +<span class="number">0x05c</span> ActiveGroupsMask : Pos <span class="number">3</span>, <span class="number">1</span> Bit			</span><br><span class="line">   +<span class="number">0x05c</span> ReservedFlags    : Pos <span class="number">4</span>, <span class="number">28</span> Bits			</span><br><span class="line">   +<span class="number">0x05c</span> ProcessFlags     : Int4B					<span class="comment">//进程flag</span></span><br><span class="line">   +<span class="number">0x060</span> BasePriority     : Char					<span class="comment">//进程默认优先级1-32</span></span><br><span class="line">   +<span class="number">0x061</span> QuantumReset     : Char					<span class="comment">//时间碎片记录 当此值为0被切换</span></span><br><span class="line">   +<span class="number">0x062</span> Visited          : UChar					</span><br><span class="line">   +<span class="number">0x063</span> Unused3          : UChar					</span><br><span class="line">   +<span class="number">0x064</span> ThreadSeed       : [<span class="number">1</span>] Uint4B				<span class="comment">//线程调整优先级的种子</span></span><br><span class="line">   +<span class="number">0x068</span> IdealNode        : [<span class="number">1</span>] Uint2B				</span><br><span class="line">   +<span class="number">0x06a</span> IdealGlobalNode  : Uint2B					</span><br><span class="line">   +<span class="number">0x06c</span> Flags            : _KEXECUTE_OPTIONS		<span class="comment">//DEP数据执行保护</span></span><br><span class="line">   +<span class="number">0x06d</span> Unused1          : UChar					</span><br><span class="line">   +<span class="number">0x06e</span> IopmOffset       : Uint2B			<span class="comment">//io权限偏移 tss段的IoMapBase加上这个就是R3权限的位图 与eflag的IOPL位相关</span></span><br><span class="line">   +<span class="number">0x070</span> Unused4          : Uint4B						</span><br><span class="line">   +<span class="number">0x074</span> StackCount       : _KSTACK_COUNT			</span><br><span class="line">   +<span class="number">0x078</span> ProcessListEntry : _LIST_ENTRY			<span class="comment">//进程链表 win7及以上没有使用		</span></span><br><span class="line">   +<span class="number">0x080</span> CycleTime        : Uint8B					<span class="comment">//时间相关</span></span><br><span class="line">   +<span class="number">0x088</span> KernelTime       : Uint4B					</span><br><span class="line">   +<span class="number">0x08c</span> UserTime         : Uint4B					</span><br><span class="line">   +<span class="number">0x090</span> VdmTrapcHandler  : Ptr32 Void				</span><br></pre></td></tr></table></figure>
<h4 id="DISPATCHER-HEADER成员（8字节）"><a href="#DISPATCHER-HEADER成员（8字节）" class="headerlink" title="_DISPATCHER_HEADER成员（8字节）"></a>_DISPATCHER_HEADER成员（8字节）</h4><p>有这个结构才能等待事件</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>: kd&gt; dt _DISPATCHER_HEADER</span><br><span class="line">ntdll!_DISPATCHER_HEADER</span><br><span class="line">   +<span class="number">0x000</span> Type             : UChar</span><br><span class="line">   +<span class="number">0x001</span> TimerControlFlags : UChar</span><br><span class="line">   +<span class="number">0x001</span> Absolute         : Pos <span class="number">0</span>, <span class="number">1</span> Bit</span><br><span class="line">   +<span class="number">0x001</span> Coalescable      : Pos <span class="number">1</span>, <span class="number">1</span> Bit</span><br><span class="line">   +<span class="number">0x001</span> KeepShifting     : Pos <span class="number">2</span>, <span class="number">1</span> Bit</span><br><span class="line">   +<span class="number">0x001</span> EncodedTolerableDelay : Pos <span class="number">3</span>, <span class="number">5</span> Bits</span><br><span class="line">   +<span class="number">0x001</span> Abandoned        : UChar</span><br><span class="line">   +<span class="number">0x001</span> Signalling       : UChar</span><br><span class="line">   +<span class="number">0x002</span> ThreadControlFlags : UChar</span><br><span class="line">   +<span class="number">0x002</span> CpuThrottled     : Pos <span class="number">0</span>, <span class="number">1</span> Bit</span><br><span class="line">   +<span class="number">0x002</span> CycleProfiling   : Pos <span class="number">1</span>, <span class="number">1</span> Bit</span><br><span class="line">   +<span class="number">0x002</span> CounterProfiling : Pos <span class="number">2</span>, <span class="number">1</span> Bit</span><br><span class="line">   +<span class="number">0x002</span> Reserved         : Pos <span class="number">3</span>, <span class="number">5</span> Bits</span><br><span class="line">   +<span class="number">0x002</span> Hand             : UChar</span><br><span class="line">   +<span class="number">0x002</span> Size             : UChar</span><br><span class="line">   +<span class="number">0x003</span> TimerMiscFlags   : UChar</span><br><span class="line">   +<span class="number">0x003</span> Index            : Pos <span class="number">0</span>, <span class="number">1</span> Bit</span><br><span class="line">   +<span class="number">0x003</span> Processor        : Pos <span class="number">1</span>, <span class="number">5</span> Bits</span><br><span class="line">   +<span class="number">0x003</span> Inserted         : Pos <span class="number">6</span>, <span class="number">1</span> Bit</span><br><span class="line">   +<span class="number">0x003</span> Expired          : Pos <span class="number">7</span>, <span class="number">1</span> Bit</span><br><span class="line">   +<span class="number">0x003</span> DebugActive      : UChar			<span class="comment">//DebugActive域</span></span><br><span class="line">   +<span class="number">0x003</span> ActiveDR7        : Pos <span class="number">0</span>, <span class="number">1</span> Bit	<span class="comment">//DR7是否活动</span></span><br><span class="line">   +<span class="number">0x003</span> Instrumented     : Pos <span class="number">1</span>, <span class="number">1</span> Bit</span><br><span class="line">   +<span class="number">0x003</span> Reserved2        : Pos <span class="number">2</span>, <span class="number">4</span> Bits	<span class="comment">//保留</span></span><br><span class="line">   +<span class="number">0x003</span> UmsScheduled     : Pos <span class="number">6</span>, <span class="number">1</span> Bit	<span class="comment">//轻量级线程调度</span></span><br><span class="line">   +<span class="number">0x003</span> UmsPrimary       : Pos <span class="number">7</span>, <span class="number">1</span> Bit	</span><br><span class="line">   +<span class="number">0x003</span> DpcActive        : UChar			<span class="comment">//DPC描述</span></span><br><span class="line">   +<span class="number">0x000</span> Lock             : Int4B</span><br><span class="line">   +<span class="number">0x004</span> SignalState      : Int4B</span><br><span class="line">   +<span class="number">0x008</span> WaitListHead     : _LIST_ENTRY</span><br></pre></td></tr></table></figure>
<h4 id="KEXECUTE-OPTIONS成员"><a href="#KEXECUTE-OPTIONS成员" class="headerlink" title="_KEXECUTE_OPTIONS成员"></a>_KEXECUTE_OPTIONS成员</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>: kd&gt; dt _KEXECUTE_OPTIONS</span><br><span class="line">ntdll!_KEXECUTE_OPTIONS</span><br><span class="line">   +<span class="number">0x000</span> ExecuteDisable   : Pos <span class="number">0</span>, <span class="number">1</span> Bit					<span class="comment">//关闭执行 1</span></span><br><span class="line">   +<span class="number">0x000</span> ExecuteEnable    : Pos <span class="number">1</span>, <span class="number">1</span> Bit					<span class="comment">//开启执行 0</span></span><br><span class="line">   +<span class="number">0x000</span> DisableThunkEmulation : Pos <span class="number">2</span>, <span class="number">1</span> Bit</span><br><span class="line">   +<span class="number">0x000</span> Permanent        : Pos <span class="number">3</span>, <span class="number">1</span> Bit</span><br><span class="line">   +<span class="number">0x000</span> ExecuteDispatchEnable : Pos <span class="number">4</span>, <span class="number">1</span> Bit</span><br><span class="line">   +<span class="number">0x000</span> ImageDispatchEnable : Pos <span class="number">5</span>, <span class="number">1</span> Bit</span><br><span class="line">   +<span class="number">0x000</span> DisableExceptionChainValidation : Pos <span class="number">6</span>, <span class="number">1</span> Bit</span><br><span class="line">   +<span class="number">0x000</span> Spare            : Pos <span class="number">7</span>, <span class="number">1</span> Bit</span><br><span class="line">   +<span class="number">0x000</span> ExecuteOptions   : UChar</span><br></pre></td></tr></table></figure>
<h1 id="KPCR"><a href="#KPCR" class="headerlink" title="KPCR"></a>KPCR</h1><p>使用WinDbg的<code>dd KeNumberProcessors</code>命令查看当前存在几个核（导出）</p>
<p><img src="https://gitee.com/ZDDR/blog_img/raw/master/img/x86_kernel_ProcessAndThread/%E6%9F%A5%E7%9C%8B%E5%BD%93%E5%89%8D%E5%AD%98%E5%9C%A8%E5%87%A0%E4%B8%AA%E6%A0%B8.png" alt="image-20201202132305219"></p>
<p>使用WinDbg的<code>dd KiProcessorBlock</code>命令查看当前所有KPRCB数组（未导出）</p>
<p><img src="https://gitee.com/ZDDR/blog_img/raw/master/img/x86_kernel_ProcessAndThread/%E6%9F%A5%E7%9C%8B%E5%BD%93%E5%89%8D%E6%89%80%E6%9C%89KPCR.png" alt="image-20201202133821735"></p>
<p>使用Windbg查看<code>gdtr</code>中的KPCR可以看到<code>807d3000</code></p>
<p><img src="https://gitee.com/ZDDR/blog_img/raw/master/img/x86_kernel_ProcessAndThread/%E4%B8%AD%E7%9A%84KPCR%E5%8F%AF%E4%BB%A5%E7%9C%8B%E5%88%B0807d3000.png" alt="image-20201202140210256"></p>
<p>那么KPCRB多出来的120是什么东西呢？使用Windbg查看KPCR结构可以看到在0x120的位置指向了KPCRB</p>
<p><img src="https://gitee.com/ZDDR/blog_img/raw/master/img/x86_kernel_ProcessAndThread/%E4%BD%BF%E7%94%A8Windbg%E6%9F%A5%E7%9C%8BKPCR%E7%BB%93%E6%9E%84%E5%8F%AF%E4%BB%A5%E7%9C%8B%E5%88%B0%E5%9C%A80x120%E7%9A%84%E4%BD%8D%E7%BD%AE%E6%8C%87%E5%90%91%E4%BA%86KPCRB.png" alt="image-20201202140436149"></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>: kd&gt; dt _KPCR <span class="number">807</span>d3000</span><br><span class="line">ntdll!_KPCR</span><br><span class="line">   +<span class="number">0x000</span> NtTib            : _NT_TIB</span><br><span class="line">   +<span class="number">0x000</span> Used_ExceptionList : <span class="number">0x807ef10c</span> _EXCEPTION_REGISTRATION_RECORD <span class="comment">//异常链表</span></span><br><span class="line">   +<span class="number">0x004</span> Used_StackBase   : (null) </span><br><span class="line">   +<span class="number">0x008</span> Spare2           : (null) </span><br><span class="line">   +<span class="number">0x00c</span> TssCopy          : <span class="number">0x807d6750</span> Void <span class="comment">//tss拷贝 保存第一份TSS _KTSS</span></span><br><span class="line">   +<span class="number">0x010</span> ContextSwitches  : <span class="number">0x47c9b</span>		<span class="comment">//R3进R0 R0进R3的次数统计</span></span><br><span class="line">   +<span class="number">0x014</span> SetMemberCopy    : <span class="number">2</span>				<span class="comment">//</span></span><br><span class="line">   +<span class="number">0x018</span> Used_Self        : (null) 		<span class="comment">//指向自己KPCR的结构（仅xp使用）</span></span><br><span class="line">   +<span class="number">0x01c</span> SelfPcr          : <span class="number">0x807d3000</span> _KPCR<span class="comment">//指向自己的指针（现在使用这个）</span></span><br><span class="line">   +<span class="number">0x020</span> Prcb             : <span class="number">0x807d3120</span> _KPRCB<span class="comment">//指向120 _KPRCB 因为下面部分是可以伸缩的</span></span><br><span class="line">   +0x024 Irql             : 0x1f &#x27;&#x27;		  //Irql 因为是WinDbg断下的 所以等级非常高</span><br><span class="line">   +<span class="number">0x028</span> IRR              : <span class="number">0</span>				  <span class="comment">//中断寄存器描述</span></span><br><span class="line">   +<span class="number">0x02c</span> IrrActive        : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x030</span> IDR              : <span class="number">0xffffffff</span></span><br><span class="line">   +<span class="number">0x034</span> KdVersionBlock   : (null) 		<span class="comment">//第一个核这里有值 DBGKD_GET_VERSION64 </span></span><br><span class="line">   +<span class="number">0x038</span> IDT              : <span class="number">0x807dc020</span> _KIDTENTRY</span><br><span class="line">   +<span class="number">0x03c</span> GDT              : <span class="number">0x807dbc20</span> _KGDTENTRY</span><br><span class="line">   +<span class="number">0x040</span> TSS              : <span class="number">0x807d6750</span> _KTSS</span><br><span class="line">   +<span class="number">0x044</span> MajorVersion     : <span class="number">1</span>				<span class="comment">//当前KPCR版本</span></span><br><span class="line">   +<span class="number">0x046</span> MinorVersion     : <span class="number">1</span>				<span class="comment">//</span></span><br><span class="line">   +<span class="number">0x048</span> SetMember        : <span class="number">2</span></span><br><span class="line">   +<span class="number">0x04c</span> StallScaleFactor : <span class="number">0xaf8</span></span><br><span class="line">   +<span class="number">0x050</span> SpareUnused      : <span class="number">0</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">   +0x051 Number           : 0x1 &#x27;&#x27;			//当前核的编号</span><br><span class="line">   +0x052 Spare0           : 0 &#x27;&#x27;			</span><br><span class="line">   +0x053 SecondLevelCacheAssociativity : 0 &#x27;&#x27; </span><br><span class="line">   +<span class="number">0x054</span> VdmAlert         : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x058</span> KernelReserved   : [<span class="number">14</span>] <span class="number">0</span></span><br><span class="line">   +<span class="number">0x090</span> SecondLevelCacheSize : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x094</span> HalReserved      : [<span class="number">16</span>] <span class="number">1</span></span><br><span class="line">   +<span class="number">0x0d4</span> InterruptMode    : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x0d8</span> Spare1           : <span class="number">0</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">   +0x0dc KernelReserved2  : [17] 0</span><br><span class="line">   +<span class="number">0x120</span> PrcbData         : _KPRCB</span><br></pre></td></tr></table></figure>
<h2 id="KPRCB"><a href="#KPRCB" class="headerlink" title="KPRCB"></a>KPRCB</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>: kd&gt; dt _KPRCB <span class="number">807</span>d3000+<span class="number">120</span></span><br><span class="line">ntdll!_KPRCB</span><br><span class="line">   +<span class="number">0x000</span> MinorVersion     : <span class="number">1</span></span><br><span class="line">   +<span class="number">0x002</span> MajorVersion     : <span class="number">1</span></span><br><span class="line">   +<span class="number">0x004</span> CurrentThread    : <span class="number">0x807d8800</span> _KTHREAD <span class="comment">//fs:[0x124]取当前线程</span></span><br><span class="line">   +<span class="number">0x008</span> NextThread       : (null) 			<span class="comment">//备用线程</span></span><br><span class="line">   +<span class="number">0x00c</span> IdleThread       : <span class="number">0x807d8800</span> _KTHREAD<span class="comment">//闲置线程</span></span><br><span class="line">   +<span class="number">0x010</span> LegacyNumber     : <span class="number">0x1</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">   +0x011 NestingLevel     : 0x1 &#x27;&#x27;</span><br><span class="line">   +<span class="number">0x012</span> BuildType        : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x014</span> CpuType          : <span class="number">6</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">   +0x015 CpuID            : 1 &#x27;&#x27;</span><br><span class="line">   +<span class="number">0x016</span> CpuStep          : <span class="number">0x9e09</span></span><br><span class="line">   +<span class="number">0x016</span> CpuStepping      : <span class="number">0x9</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">   +0x017 CpuModel         : 0x9e &#x27;&#x27;</span><br><span class="line">   +<span class="number">0x018</span> ProcessorState   : _KPROCESSOR_STATE</span><br><span class="line">   +<span class="number">0x338</span> KernelReserved   : [<span class="number">16</span>] <span class="number">0</span></span><br><span class="line">   +<span class="number">0x378</span> HalReserved      : [<span class="number">16</span>] <span class="number">0x9600</span></span><br><span class="line">   +<span class="number">0x3b8</span> CFlushSize       : <span class="number">0x40</span></span><br><span class="line">   +<span class="number">0x3bc</span> CoresPerPhysicalProcessor : <span class="number">0x2</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">   +0x3bd LogicalProcessorsPerCore : 0x1 &#x27;&#x27;</span><br><span class="line">   +<span class="number">0x3be</span> PrcbPad0         : [<span class="number">2</span>]  <span class="string">&quot;&quot;</span></span><br><span class="line">   +<span class="number">0x3c0</span> MHz              : <span class="number">0xaf8</span></span><br><span class="line">   +<span class="number">0x3c4</span> CpuVendor        : <span class="number">0x1</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">   +0x3c5 GroupIndex       : 0x1 &#x27;&#x27;</span><br><span class="line">   +<span class="number">0x3c6</span> Group            : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x3c8</span> GroupSetMember   : <span class="number">2</span></span><br><span class="line">   +<span class="number">0x3cc</span> Number           : <span class="number">1</span></span><br><span class="line">   +<span class="number">0x3d0</span> PrcbPad1         : [<span class="number">72</span>]  <span class="string">&quot;&quot;</span></span><br><span class="line">   +<span class="number">0x418</span> LockQueue        : [<span class="number">17</span>] _KSPIN_LOCK_QUEUE</span><br><span class="line">   +<span class="number">0x4a0</span> NpxThread        : (null) </span><br><span class="line">   +<span class="number">0x4a4</span> InterruptCount   : <span class="number">0x65784</span></span><br><span class="line">   +<span class="number">0x4a8</span> KernelTime       : <span class="number">0x7525</span></span><br><span class="line">   +<span class="number">0x4ac</span> UserTime         : <span class="number">0x17c</span></span><br><span class="line">   +<span class="number">0x4b0</span> DpcTime          : <span class="number">4</span></span><br><span class="line">   +<span class="number">0x4b4</span> DpcTimeCount     : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x4b8</span> InterruptTime    : <span class="number">0x23</span></span><br><span class="line">   +<span class="number">0x4bc</span> AdjustDpcThreshold : <span class="number">0x12</span></span><br><span class="line">   +<span class="number">0x4c0</span> PageColor        : <span class="number">0x21e1</span></span><br><span class="line">   +<span class="number">0x4c4</span> DebuggerSavedIRQL : <span class="number">0x1c</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">   +0x4c5 NodeColor        : 0 &#x27;&#x27;</span><br><span class="line">   +<span class="number">0x4c6</span> PrcbPad20        : [<span class="number">2</span>]  <span class="string">&quot;&quot;</span></span><br><span class="line">   +<span class="number">0x4c8</span> NodeShiftedColor : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x4cc</span> ParentNode       : <span class="number">0x83f4d300</span> _KNODE</span><br><span class="line">   +<span class="number">0x4d0</span> SecondaryColorMask : <span class="number">0x7f</span></span><br><span class="line">   +<span class="number">0x4d4</span> DpcTimeLimit     : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x4d8</span> PrcbPad21        : [<span class="number">2</span>] <span class="number">0</span></span><br><span class="line">   +<span class="number">0x4e0</span> CcFastReadNoWait : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x4e4</span> CcFastReadWait   : <span class="number">0x10ce</span></span><br><span class="line">   +<span class="number">0x4e8</span> CcFastReadNotPossible : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x4ec</span> CcCopyReadNoWait : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x4f0</span> CcCopyReadWait   : <span class="number">0x1688</span></span><br><span class="line">   +<span class="number">0x4f4</span> CcCopyReadNoWaitMiss : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x4f8</span> MmSpinLockOrdering : <span class="number">0</span>n0</span><br><span class="line">   +<span class="number">0x4fc</span> IoReadOperationCount : <span class="number">0</span>n7122</span><br><span class="line">   +<span class="number">0x500</span> IoWriteOperationCount : <span class="number">0</span>n1605</span><br><span class="line">   +<span class="number">0x504</span> IoOtherOperationCount : <span class="number">0</span>n331141</span><br><span class="line">   +<span class="number">0x508</span> IoReadTransferCount : _LARGE_INTEGER <span class="number">0x88b6ba8</span></span><br><span class="line">   +<span class="number">0x510</span> IoWriteTransferCount : _LARGE_INTEGER <span class="number">0x5e1255</span></span><br><span class="line">   +<span class="number">0x518</span> IoOtherTransferCount : _LARGE_INTEGER <span class="number">0x40f9f8</span></span><br><span class="line">   +<span class="number">0x520</span> CcFastMdlReadNoWait : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x524</span> CcFastMdlReadWait : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x528</span> CcFastMdlReadNotPossible : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x52c</span> CcMapDataNoWait  : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x530</span> CcMapDataWait    : <span class="number">0x286ce</span></span><br><span class="line">   +<span class="number">0x534</span> CcPinMappedDataCount : <span class="number">0x630</span></span><br><span class="line">   +<span class="number">0x538</span> CcPinReadNoWait  : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x53c</span> CcPinReadWait    : <span class="number">0x22b</span></span><br><span class="line">   +<span class="number">0x540</span> CcMdlReadNoWait  : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x544</span> CcMdlReadWait    : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x548</span> CcLazyWriteHotSpots : <span class="number">0xd</span></span><br><span class="line">   +<span class="number">0x54c</span> CcLazyWriteIos   : <span class="number">0x68</span></span><br><span class="line">   +<span class="number">0x550</span> CcLazyWritePages : <span class="number">0xdc</span></span><br><span class="line">   +<span class="number">0x554</span> CcDataFlushes    : <span class="number">0x1a9</span></span><br><span class="line">   +<span class="number">0x558</span> CcDataPages      : <span class="number">0x315</span></span><br><span class="line">   +<span class="number">0x55c</span> CcLostDelayedWrites : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x560</span> CcFastReadResourceMiss : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x564</span> CcCopyReadWaitMiss : <span class="number">0x1e8a</span></span><br><span class="line">   +<span class="number">0x568</span> CcFastMdlReadResourceMiss : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x56c</span> CcMapDataNoWaitMiss : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x570</span> CcMapDataWaitMiss : <span class="number">0x5c9</span></span><br><span class="line">   +<span class="number">0x574</span> CcPinReadNoWaitMiss : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x578</span> CcPinReadWaitMiss : <span class="number">7</span></span><br><span class="line">   +<span class="number">0x57c</span> CcMdlReadNoWaitMiss : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x580</span> CcMdlReadWaitMiss : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x584</span> CcReadAheadIos   : <span class="number">0x2ef</span></span><br><span class="line">   +<span class="number">0x588</span> KeAlignmentFixupCount : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x58c</span> KeExceptionDispatchCount : <span class="number">0x8ed</span></span><br><span class="line">   +<span class="number">0x590</span> KeSystemCalls    : <span class="number">0x29d235</span></span><br><span class="line">   +<span class="number">0x594</span> AvailableTime    : <span class="number">0x8e</span></span><br><span class="line">   +<span class="number">0x598</span> PrcbPad22        : [<span class="number">2</span>] <span class="number">0</span></span><br><span class="line">   +<span class="number">0x5a0</span> PPLookasideList  : [<span class="number">16</span>] _PP_LOOKASIDE_LIST</span><br><span class="line">   +<span class="number">0x620</span> PPNPagedLookasideList : [<span class="number">32</span>] _GENERAL_LOOKASIDE_POOL</span><br><span class="line">   +<span class="number">0xf20</span> PPPagedLookasideList : [<span class="number">32</span>] _GENERAL_LOOKASIDE_POOL</span><br><span class="line">   +<span class="number">0x1820</span> PacketBarrier    : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x1824</span> ReverseStall     : <span class="number">0</span>n29</span><br><span class="line">   +<span class="number">0x1828</span> IpiFrame         : <span class="number">0x807efb28</span> Void</span><br><span class="line">   +<span class="number">0x182c</span> PrcbPad3         : [<span class="number">52</span>]  <span class="string">&quot;&quot;</span></span><br><span class="line">   +<span class="number">0x1860</span> CurrentPacket    : [<span class="number">3</span>] (null) </span><br><span class="line">   +<span class="number">0x186c</span> TargetSet        : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x1870</span> WorkerRoutine    : <span class="number">0x83eaea43</span>     <span class="keyword">void</span>  nt!KiFlushTargetMultipleRangeTb+<span class="number">0</span></span><br><span class="line">   +<span class="number">0x1874</span> IpiFrozen        : <span class="number">0x24</span></span><br><span class="line">   +<span class="number">0x1878</span> PrcbPad4         : [<span class="number">40</span>]  <span class="string">&quot;&quot;</span></span><br><span class="line">   +<span class="number">0x18a0</span> RequestSummary   : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x18a4</span> SignalDone       : (null) </span><br><span class="line">   +<span class="number">0x18a8</span> PrcbPad50        : [<span class="number">56</span>]  <span class="string">&quot;&quot;</span></span><br><span class="line">   +<span class="number">0x18e0</span> DpcData          : [<span class="number">2</span>] _KDPC_DATA</span><br><span class="line">   +<span class="number">0x1908</span> DpcStack         : <span class="number">0x807f4000</span> Void</span><br><span class="line">   +<span class="number">0x190c</span> MaximumDpcQueueDepth : <span class="number">0</span>n4</span><br><span class="line">   +<span class="number">0x1910</span> DpcRequestRate   : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x1914</span> MinimumDpcRate   : <span class="number">3</span></span><br><span class="line">   +<span class="number">0x1918</span> DpcLastCount     : <span class="number">0x775</span></span><br><span class="line">   +<span class="number">0x191c</span> PrcbLock         : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x1920</span> DpcGate          : _KGATE</span><br><span class="line">   +<span class="number">0x1930</span> ThreadDpcEnable  : <span class="number">0x1</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">   +0x1931 QuantumEnd       : 0 &#x27;&#x27;</span><br><span class="line">   +<span class="number">0x1932</span> DpcRoutineActive : <span class="number">0</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">   +0x1933 IdleSchedule     : 0 &#x27;&#x27;</span><br><span class="line">   +<span class="number">0x1934</span> DpcRequestSummary : <span class="number">0</span>n0</span><br><span class="line">   +<span class="number">0x1934</span> DpcRequestSlot   : [<span class="number">2</span>] <span class="number">0</span>n0</span><br><span class="line">   +<span class="number">0x1934</span> NormalDpcState   : <span class="number">0</span>n0</span><br><span class="line">   +<span class="number">0x1936</span> DpcThreadActive  : <span class="number">0</span>y0</span><br><span class="line">   +<span class="number">0x1936</span> ThreadDpcState   : <span class="number">0</span>n0</span><br><span class="line">   +<span class="number">0x1938</span> TimerHand        : <span class="number">0x7a71</span></span><br><span class="line">   +<span class="number">0x193c</span> LastTick         : <span class="number">0x7a74</span></span><br><span class="line">   +<span class="number">0x1940</span> MasterOffset     : <span class="number">0</span>n0</span><br><span class="line">   +<span class="number">0x1944</span> PrcbPad41        : [<span class="number">2</span>] <span class="number">0</span></span><br><span class="line">   +<span class="number">0x194c</span> PeriodicCount    : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x1950</span> PeriodicBias     : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x1958</span> TickOffset       : <span class="number">0xb19</span></span><br><span class="line">   +<span class="number">0x1960</span> TimerTable       : _KTIMER_TABLE</span><br><span class="line">   +<span class="number">0x31a0</span> CallDpc          : _KDPC</span><br><span class="line">   +<span class="number">0x31c0</span> ClockKeepAlive   : <span class="number">0</span>n1</span><br><span class="line">   +<span class="number">0x31c4</span> ClockCheckSlot   : <span class="number">0</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">   +0x31c5 ClockPollCycle   : 0x64 &#x27;d&#x27;</span><br><span class="line">   +<span class="number">0x31c6</span> PrcbPad6         : [<span class="number">2</span>]  <span class="string">&quot;&quot;</span></span><br><span class="line">   +<span class="number">0x31c8</span> DpcWatchdogPeriod : <span class="number">0</span>n0</span><br><span class="line">   +<span class="number">0x31cc</span> DpcWatchdogCount : <span class="number">0</span>n0</span><br><span class="line">   +<span class="number">0x31d0</span> ThreadWatchdogPeriod : <span class="number">0</span>n0</span><br><span class="line">   +<span class="number">0x31d4</span> ThreadWatchdogCount : <span class="number">0</span>n0</span><br><span class="line">   +<span class="number">0x31d8</span> KeSpinLockOrdering : <span class="number">0</span>n0</span><br><span class="line">   +<span class="number">0x31dc</span> PrcbPad70        : [<span class="number">1</span>] <span class="number">0</span></span><br><span class="line">   +<span class="number">0x31e0</span> WaitListHead     : _LIST_ENTRY [ <span class="number">0x86053c1c</span> - <span class="number">0x85ef9534</span> ]</span><br><span class="line">   +<span class="number">0x31e8</span> WaitLock         : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x31ec</span> ReadySummary     : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x31f0</span> QueueIndex       : <span class="number">1</span></span><br><span class="line">   +<span class="number">0x31f4</span> DeferredReadyListHead : _SINGLE_LIST_ENTRY <span class="comment">//线程切换就绪链表（xp没有win7及以上才有）</span></span><br><span class="line">   +<span class="number">0x31f8</span> StartCycles      : <span class="number">0x0000019e</span>`a8b149e0</span><br><span class="line">   +<span class="number">0x3200</span> CycleTime        : <span class="number">0x0000002a</span>`d163764d</span><br><span class="line">   +<span class="number">0x3208</span> HighCycleTime    : <span class="number">0x2a</span></span><br><span class="line">   +<span class="number">0x320c</span> PrcbPad71        : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x3210</span> PrcbPad72        : [<span class="number">2</span>] <span class="number">0</span></span><br><span class="line">   +<span class="number">0x3220</span> DispatcherReadyListHead : [<span class="number">32</span>] _LIST_ENTRY [ <span class="number">0x807d6340</span> - <span class="number">0x807d6340</span> ]</span><br><span class="line">   +<span class="number">0x3320</span> ChainedInterruptList : (null) </span><br><span class="line">   +<span class="number">0x3324</span> LookasideIrpFloat : <span class="number">0</span>n2147483647</span><br><span class="line">   +<span class="number">0x3328</span> MmPageFaultCount : <span class="number">0</span>n313770</span><br><span class="line">   +<span class="number">0x332c</span> MmCopyOnWriteCount : <span class="number">0</span>n5357</span><br><span class="line">   +<span class="number">0x3330</span> MmTransitionCount : <span class="number">0</span>n130752</span><br><span class="line">   +<span class="number">0x3334</span> MmCacheTransitionCount : <span class="number">0</span>n0</span><br><span class="line">   +<span class="number">0x3338</span> MmDemandZeroCount : <span class="number">0</span>n163442</span><br><span class="line">   +<span class="number">0x333c</span> MmPageReadCount  : <span class="number">0</span>n37894</span><br><span class="line">   +<span class="number">0x3340</span> MmPageReadIoCount : <span class="number">0</span>n9143</span><br><span class="line">   +<span class="number">0x3344</span> MmCacheReadCount : <span class="number">0</span>n0</span><br><span class="line">   +<span class="number">0x3348</span> MmCacheIoCount   : <span class="number">0</span>n0</span><br><span class="line">   +<span class="number">0x334c</span> MmDirtyPagesWriteCount : <span class="number">0</span>n0</span><br><span class="line">   +<span class="number">0x3350</span> MmDirtyWriteIoCount : <span class="number">0</span>n0</span><br><span class="line">   +<span class="number">0x3354</span> MmMappedPagesWriteCount : <span class="number">0</span>n0</span><br><span class="line">   +<span class="number">0x3358</span> MmMappedWriteIoCount : <span class="number">0</span>n0</span><br><span class="line">   +<span class="number">0x335c</span> CachedCommit     : <span class="number">0xf8</span></span><br><span class="line">   +<span class="number">0x3360</span> CachedResidentAvailable : <span class="number">0xc0</span></span><br><span class="line">   +<span class="number">0x3364</span> HyperPte         : <span class="number">0x8d700004</span> Void</span><br><span class="line">   +<span class="number">0x3368</span> PrcbPad8         : [<span class="number">4</span>]  <span class="string">&quot;&quot;</span></span><br><span class="line">   +<span class="number">0x336c</span> VendorString     : [<span class="number">13</span>]  <span class="string">&quot;GenuineIntel&quot;</span></span><br><span class="line">   +<span class="number">0x3379</span> InitialApicId    : <span class="number">0x1</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">   +0x337a LogicalProcessorsPerPhysicalProcessor : 0x2 &#x27;&#x27;</span><br><span class="line">   +<span class="number">0x337b</span> PrcbPad9         : [<span class="number">5</span>]  <span class="string">&quot;&quot;</span></span><br><span class="line">   +<span class="number">0x3380</span> FeatureBits      : <span class="number">0xa0cd3fff</span></span><br><span class="line">   +<span class="number">0x3388</span> UpdateSignature  : _LARGE_INTEGER <span class="number">0x0000008e</span>`<span class="number">00000000</span></span><br><span class="line">   +<span class="number">0x3390</span> IsrTime          : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x3398</span> RuntimeAccumulation : <span class="number">0x00000001</span>`<span class="number">237</span>c6246</span><br><span class="line">   +<span class="number">0x33a0</span> PowerState       : _PROCESSOR_POWER_STATE</span><br><span class="line">   +<span class="number">0x3468</span> DpcWatchdogDpc   : _KDPC</span><br><span class="line">   +<span class="number">0x3488</span> DpcWatchdogTimer : _KTIMER</span><br><span class="line">   +<span class="number">0x34b0</span> WheaInfo         : <span class="number">0x85ef92ec</span> Void</span><br><span class="line">   +<span class="number">0x34b4</span> EtwSupport       : <span class="number">0x85ed3008</span> Void</span><br><span class="line">   +<span class="number">0x34b8</span> InterruptObjectPool : _SLIST_HEADER</span><br><span class="line">   +<span class="number">0x34c0</span> HypercallPageList : _SLIST_HEADER</span><br><span class="line">   +<span class="number">0x34c8</span> HypercallPageVirtual : <span class="number">0x807f4000</span> Void</span><br><span class="line">   +<span class="number">0x34cc</span> VirtualApicAssist : (null) </span><br><span class="line">   +<span class="number">0x34d0</span> StatisticsPage   : (null) </span><br><span class="line">   +<span class="number">0x34d4</span> RateControl      : (null) </span><br><span class="line">   +<span class="number">0x34d8</span> Cache            : [<span class="number">5</span>] _CACHE_DESCRIPTOR</span><br><span class="line">   +<span class="number">0x3514</span> CacheCount       : <span class="number">4</span></span><br><span class="line">   +<span class="number">0x3518</span> CacheProcessorMask : [<span class="number">5</span>] <span class="number">2</span></span><br><span class="line">   +<span class="number">0x352c</span> PackageProcessorSet : _KAFFINITY_EX</span><br><span class="line">   +<span class="number">0x3538</span> PrcbPad91        : [<span class="number">1</span>] <span class="number">0</span></span><br><span class="line">   +<span class="number">0x353c</span> CoreProcessorSet : <span class="number">2</span></span><br><span class="line">   +<span class="number">0x3540</span> TimerExpirationDpc : _KDPC</span><br><span class="line">   +<span class="number">0x3560</span> SpinLockAcquireCount : <span class="number">0x3d8a6f</span></span><br><span class="line">   +<span class="number">0x3564</span> SpinLockContentionCount : <span class="number">0x1ae8</span></span><br><span class="line">   +<span class="number">0x3568</span> SpinLockSpinCount : <span class="number">0x2a39</span></span><br><span class="line">   +<span class="number">0x356c</span> IpiSendRequestBroadcastCount : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x3570</span> IpiSendRequestRoutineCount : <span class="number">0x1e890</span></span><br><span class="line">   +<span class="number">0x3574</span> IpiSendSoftwareInterruptCount : <span class="number">0x10b6e</span></span><br><span class="line">   +<span class="number">0x3578</span> ExInitializeResourceCount : <span class="number">0x4663</span></span><br><span class="line">   +<span class="number">0x357c</span> ExReInitializeResourceCount : <span class="number">0x411</span></span><br><span class="line">   +<span class="number">0x3580</span> ExDeleteResourceCount : <span class="number">0x3b3c</span></span><br><span class="line">   +<span class="number">0x3584</span> ExecutiveResourceAcquiresCount : <span class="number">0x37ad1c</span></span><br><span class="line">   +<span class="number">0x3588</span> ExecutiveResourceContentionsCount : <span class="number">0xe20</span></span><br><span class="line">   +<span class="number">0x358c</span> ExecutiveResourceReleaseExclusiveCount : <span class="number">0xb483e</span></span><br><span class="line">   +<span class="number">0x3590</span> ExecutiveResourceReleaseSharedCount : <span class="number">0x2c5f1c</span></span><br><span class="line">   +<span class="number">0x3594</span> ExecutiveResourceConvertsCount : <span class="number">0x22c</span></span><br><span class="line">   +<span class="number">0x3598</span> ExAcqResExclusiveAttempts : <span class="number">0xb1b32</span></span><br><span class="line">   +<span class="number">0x359c</span> ExAcqResExclusiveAcquiresExclusive : <span class="number">0xaa172</span></span><br><span class="line">   +<span class="number">0x35a0</span> ExAcqResExclusiveAcquiresExclusiveRecursive : <span class="number">0x782d</span></span><br><span class="line">   +<span class="number">0x35a4</span> ExAcqResExclusiveWaits : <span class="number">0x8c2</span></span><br><span class="line">   +<span class="number">0x35a8</span> ExAcqResExclusiveNotAcquires : <span class="number">0x193</span></span><br><span class="line">   +<span class="number">0x35ac</span> ExAcqResSharedAttempts : <span class="number">0x2bcd37</span></span><br><span class="line">   +<span class="number">0x35b0</span> ExAcqResSharedAcquiresExclusive : <span class="number">0x338b</span></span><br><span class="line">   +<span class="number">0x35b4</span> ExAcqResSharedAcquiresShared : <span class="number">0x2b662e</span></span><br><span class="line">   +<span class="number">0x35b8</span> ExAcqResSharedAcquiresSharedRecursive : <span class="number">0x3373</span></span><br><span class="line">   +<span class="number">0x35bc</span> ExAcqResSharedWaits : <span class="number">0x55e</span></span><br><span class="line">   +<span class="number">0x35c0</span> ExAcqResSharedNotAcquires : <span class="number">0xb</span></span><br><span class="line">   +<span class="number">0x35c4</span> ExAcqResSharedStarveExclusiveAttempts : <span class="number">0xc651</span></span><br><span class="line">   +<span class="number">0x35c8</span> ExAcqResSharedStarveExclusiveAcquiresExclusive : <span class="number">1</span></span><br><span class="line">   +<span class="number">0x35cc</span> ExAcqResSharedStarveExclusiveAcquiresShared : <span class="number">0xc5d9</span></span><br><span class="line">   +<span class="number">0x35d0</span> ExAcqResSharedStarveExclusiveAcquiresSharedRecursive : <span class="number">0x77</span></span><br><span class="line">   +<span class="number">0x35d4</span> ExAcqResSharedStarveExclusiveWaits : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x35d8</span> ExAcqResSharedStarveExclusiveNotAcquires : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x35dc</span> ExAcqResSharedWaitForExclusiveAttempts : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x35e0</span> ExAcqResSharedWaitForExclusiveAcquiresExclusive : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x35e4</span> ExAcqResSharedWaitForExclusiveAcquiresShared : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x35e8</span> ExAcqResSharedWaitForExclusiveAcquiresSharedRecursive : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x35ec</span> ExAcqResSharedWaitForExclusiveWaits : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x35f0</span> ExAcqResSharedWaitForExclusiveNotAcquires : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x35f4</span> ExSetResOwnerPointerExclusive : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x35f8</span> ExSetResOwnerPointerSharedNew : <span class="number">0x191</span></span><br><span class="line">   +<span class="number">0x35fc</span> ExSetResOwnerPointerSharedOld : <span class="number">0x108</span></span><br><span class="line">   +<span class="number">0x3600</span> ExTryToAcqExclusiveAttempts : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x3604</span> ExTryToAcqExclusiveAcquires : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x3608</span> ExBoostExclusiveOwner : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x360c</span> ExBoostSharedOwners : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x3610</span> ExEtwSynchTrackingNotificationsCount : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x3614</span> ExEtwSynchTrackingNotificationsAccountedCount : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x3618</span> Context          : <span class="number">0x8d710340</span> _CONTEXT</span><br><span class="line">   +<span class="number">0x361c</span> ContextFlags     : <span class="number">0x1007f</span></span><br><span class="line">   +<span class="number">0x3620</span> ExtendedState    : <span class="number">0x8d710000</span> _XSAVE_AREA</span><br></pre></td></tr></table></figure>
<h2 id="DBGKD-GET-VERSION64"><a href="#DBGKD-GET-VERSION64" class="headerlink" title="DBGKD_GET_VERSION64"></a>DBGKD_GET_VERSION64</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>: kd&gt; dt _DBGKD_GET_VERSION64 <span class="number">0x83f42c00</span></span><br><span class="line">nt!_DBGKD_GET_VERSION64</span><br><span class="line">   +<span class="number">0x000</span> MajorVersion     : <span class="number">0xf</span></span><br><span class="line">   +<span class="number">0x002</span> MinorVersion     : <span class="number">0x1db1</span></span><br><span class="line">   +<span class="number">0x004</span> ProtocolVersion  : <span class="number">0x6</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">   +0x005 KdSecondaryVersion : 0 &#x27;&#x27;</span><br><span class="line">   +<span class="number">0x006</span> Flags            : <span class="number">3</span></span><br><span class="line">   +<span class="number">0x008</span> MachineType      : <span class="number">0x14c</span></span><br><span class="line">   +<span class="number">0x00a</span> MaxPacketType    : <span class="number">0xc</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">   +0x00b MaxStateChange   : 0x3 &#x27;&#x27;</span><br><span class="line">   +<span class="number">0x00c</span> MaxManipulate    : <span class="number">0x2f</span> <span class="string">&#x27;/&#x27;</span></span><br><span class="line">   +<span class="number">0x00d</span> Simulation       : <span class="number">0</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">   +0x00e Unused           : [1] 0</span><br><span class="line">   +<span class="number">0x010</span> KernBase         : <span class="number">0xffffffff</span>`<span class="number">83e18000</span>	<span class="comment">//驱动模块基址</span></span><br><span class="line">   +<span class="number">0x018</span> PsLoadedModuleList : <span class="number">0xffffffff</span>`<span class="number">83f</span>62850	<span class="comment">//驱动链表  _LDR_DATA_TABLE_ENIRY</span></span><br><span class="line">   +<span class="number">0x020</span> DebuggerDataList : <span class="number">0xffffffff</span>`<span class="number">84188f</span>ec	<span class="comment">//调试数据链表</span></span><br></pre></td></tr></table></figure>
<p><img src="https://gitee.com/ZDDR/blog_img/raw/master/img/x86_kernel_ProcessAndThread/niubi%E7%9A%84%E4%B8%9C%E8%A5%BF.png" alt="image-20201202153346502"></p>
<p>KDDEBUGGER_DATA64（但是实际运行起来比这个结构多）</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>: kd&gt; dds <span class="number">83f</span>42c28 L100</span><br><span class="line">ReadVirtual: <span class="number">83f</span>42ca8 <span class="keyword">not</span> properly sign extended</span><br><span class="line"><span class="number">83f</span>42c28  <span class="number">84188f</span>ec nt!KdpDebuggerDataListHead</span><br><span class="line"><span class="number">83f</span>42c2c  <span class="number">84188f</span>ec nt!KdpDebuggerDataListHead</span><br><span class="line"><span class="number">83f</span>42c30  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42c34  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42c38  <span class="number">4742444b</span></span><br><span class="line"><span class="number">83f</span>42c3c  <span class="number">00000340</span></span><br><span class="line"><span class="number">83f</span>42c40  <span class="number">83e18000</span> nt!_imp__VidBitBlt &lt;PERF&gt; (nt+<span class="number">0x0</span>)</span><br><span class="line"><span class="number">83f</span>42c44  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42c48  <span class="number">83e93110</span> nt!RtlpBreakWithStatusInstruction</span><br><span class="line"><span class="number">83f</span>42c4c  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42c50  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42c54  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42c58  <span class="number">00080130</span></span><br><span class="line"><span class="number">83f</span>42c5c  <span class="number">00010018</span></span><br><span class="line"><span class="number">83f</span>42c60  <span class="number">83e97584</span> nt!KiCallUserMode</span><br><span class="line"><span class="number">83f</span>42c64  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42c68  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42c6c  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42c70  <span class="number">83f</span>62850 nt!PsLoadedModuleList</span><br><span class="line"><span class="number">83f</span>42c74  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42c78  <span class="number">83f</span>5af18 nt!PsActiveProcessHead</span><br><span class="line"><span class="number">83f</span>42c7c  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42c80  <span class="number">83f</span>5af34 nt!PspCidTable</span><br><span class="line"><span class="number">83f</span>42c84  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42c88  <span class="number">83f</span>54718 nt!ExpSystemResourcesList</span><br><span class="line"><span class="number">83f</span>42c8c  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42c90  <span class="number">83f</span>54b60 nt!ExpPagedPoolDescriptor</span><br><span class="line"><span class="number">83f</span>42c94  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42c98  <span class="number">83f</span>82014 nt!ExpNumberOfPagedPools</span><br><span class="line"><span class="number">83f</span>42c9c  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42ca0  <span class="number">83f</span>82888 nt!KeTimeIncrement</span><br><span class="line"><span class="number">83f</span>42ca4  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42ca8  <span class="number">83f</span>7db60 nt!KeBugCheckCallbackListHead</span><br><span class="line"><span class="number">83f</span>42cac  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42cb0  <span class="number">83f</span>7aa40 nt!KiBugCheckData</span><br><span class="line"><span class="number">83f</span>42cb4  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42cb8  <span class="number">83f</span>807a0 nt!IopErrorLogListHead</span><br><span class="line"><span class="number">83f</span>42cbc  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42cc0  <span class="number">83f</span>5bac8 nt!ObpRootDirectoryObject</span><br><span class="line"><span class="number">83f</span>42cc4  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42cc8  <span class="number">83f</span>5bad4 nt!ObpTypeObjectType</span><br><span class="line"><span class="number">83f</span>42ccc  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42cd0  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42cd4  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42cd8  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42cdc  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42ce0  <span class="number">83f</span>4e540 nt!MmSystemCacheWs</span><br><span class="line"><span class="number">83f</span>42ce4  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42ce8  <span class="number">83f</span>82700 nt!MmPfnDatabase</span><br><span class="line"><span class="number">83f</span>42cec  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42cf0  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42cf4  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42cf8  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42cfc  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42d00  <span class="number">83f</span>82704 nt!MmSubsectionBase</span><br><span class="line"><span class="number">83f</span>42d04  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42d08  <span class="number">83f</span>61d84 nt!MmNumberOfPagingFiles</span><br><span class="line"><span class="number">83f</span>42d0c  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42d10  <span class="number">83f</span>82708 nt!MmLowestPhysicalPage</span><br><span class="line"><span class="number">83f</span>42d14  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42d18  <span class="number">83f</span>8270c nt!MmHighestPhysicalPage</span><br><span class="line"><span class="number">83f</span>42d1c  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42d20  <span class="number">83f</span>82710 nt!MmNumberOfPhysicalPages</span><br><span class="line"><span class="number">83f</span>42d24  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42d28  <span class="number">83f</span>82128 nt!MmMaximumNonPagedPoolInBytes</span><br><span class="line"><span class="number">83f</span>42d2c  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42d30  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42d34  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42d38  <span class="number">83f</span>8212c nt!MmNonPagedPoolStart</span><br><span class="line"><span class="number">83f</span>42d3c  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42d40  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42d44  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42d48  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42d4c  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42d50  <span class="number">83f</span>82098 nt!MmPagedPoolEnd</span><br><span class="line"><span class="number">83f</span>42d54  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42d58  <span class="number">83f</span>8209c nt!MmPagedPoolInfo</span><br><span class="line"><span class="number">83f</span>42d5c  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42d60  <span class="number">00001000</span></span><br><span class="line"><span class="number">83f</span>42d64  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42d68  <span class="number">83f</span>825d0 nt!MmSizeOfPagedPoolInBytes</span><br><span class="line"><span class="number">83f</span>42d6c  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42d70  <span class="number">83f</span>61394 nt!MmTotalCommitLimit</span><br><span class="line"><span class="number">83f</span>42d74  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42d78  <span class="number">83f</span>61398 nt!MmTotalCommittedPages</span><br><span class="line"><span class="number">83f</span>42d7c  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42d80  <span class="number">83f</span>51224 nt!MmSharedCommit</span><br><span class="line"><span class="number">83f</span>42d84  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42d88  <span class="number">83f</span>628c0 nt!MmDriverCommit</span><br><span class="line"><span class="number">83f</span>42d8c  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42d90  <span class="number">83f</span>61378 nt!MmProcessCommit</span><br><span class="line"><span class="number">83f</span>42d94  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42d98  <span class="number">83f</span>613c0 nt!MmPagedPoolCommit</span><br><span class="line"><span class="number">83f</span>42d9c  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42da0  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42da4  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42da8  <span class="number">83f</span>83000 nt!MmZeroedPageListHead</span><br><span class="line"><span class="number">83f</span>42dac  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42db0  <span class="number">83f</span>83040 nt!MmFreePageListHead</span><br><span class="line"><span class="number">83f</span>42db4  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42db8  <span class="number">83f</span>83080 nt!MmStandbyPageListHead</span><br><span class="line"><span class="number">83f</span>42dbc  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42dc0  <span class="number">83f</span>830c0 nt!MmModifiedPageListHead</span><br><span class="line"><span class="number">83f</span>42dc4  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42dc8  <span class="number">83f</span>4294c nt!MmModifiedNoWritePageListHead</span><br><span class="line"><span class="number">83f</span>42dcc  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42dd0  <span class="number">83f</span>47480 nt!MmAvailablePages</span><br><span class="line"><span class="number">83f</span>42dd4  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42dd8  <span class="number">83f</span>47500 nt!MmResidentAvailablePages</span><br><span class="line"><span class="number">83f</span>42ddc  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42de0  <span class="number">83f</span>54c24 nt!PoolTrackTable</span><br><span class="line"><span class="number">83f</span>42de4  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42de8  <span class="number">83f</span>4f940 nt!NonPagedPoolDescriptor</span><br><span class="line"><span class="number">83f</span>42dec  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42df0  <span class="number">83f</span>82714 nt!MmHighestUserAddress</span><br><span class="line"><span class="number">83f</span>42df4  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42df8  <span class="number">83f</span>82718 nt!MmSystemRangeStart</span><br><span class="line"><span class="number">83f</span>42dfc  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42e00  <span class="number">83f</span>8271c nt!MmUserProbeAddress</span><br><span class="line"><span class="number">83f</span>42e04  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42e08  <span class="number">84185000</span> nt!KdPrintDefaultCircularBuffer</span><br><span class="line"><span class="number">83f</span>42e0c  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42e10  <span class="number">84186000</span> nt!KdPrintWritePointer</span><br><span class="line"><span class="number">83f</span>42e14  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42e18  <span class="number">84186000</span> nt!KdPrintWritePointer</span><br><span class="line"><span class="number">83f</span>42e1c  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42e20  <span class="number">84186004</span> nt!KdPrintRolloverCount</span><br><span class="line"><span class="number">83f</span>42e24  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42e28  <span class="number">83f</span>62e38 nt!MmLoadedUserImageList</span><br><span class="line"><span class="number">83f</span>42e2c  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42e30  <span class="number">83e62</span>fa8 nt!NtBuildLabEx</span><br><span class="line"><span class="number">83f</span>42e34  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42e38  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42e3c  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42e40  <span class="number">83f</span>828c0 nt!KiProcessorBlock</span><br><span class="line"><span class="number">83f</span>42e44  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42e48  <span class="number">83f</span>82560 nt!MmUnloadedDrivers</span><br><span class="line"><span class="number">83f</span>42e4c  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42e50  <span class="number">83f</span>6284c nt!MmLastUnloadedDriver</span><br><span class="line"><span class="number">83f</span>42e54  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42e58  <span class="number">83f</span>59ef4 nt!VerifierTriageActionTaken</span><br><span class="line"><span class="number">83f</span>42e5c  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42e60  <span class="number">83f</span>82144 nt!MmSpecialPoolTag</span><br><span class="line"><span class="number">83f</span>42e64  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42e68  <span class="number">83f</span>53a60 nt!KernelVerifier</span><br><span class="line"><span class="number">83f</span>42e6c  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42e70  <span class="number">83f</span>62b80 nt!MmVerifierData</span><br><span class="line"><span class="number">83f</span>42e74  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42e78  <span class="number">83f</span>620cc nt!MmAllocatedNonPagedPool</span><br><span class="line"><span class="number">83f</span>42e7c  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42e80  <span class="number">83f</span>613b8 nt!MmPeakCommitment</span><br><span class="line"><span class="number">83f</span>42e84  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42e88  <span class="number">83f</span>6139c nt!MmTotalCommitLimitMaximum</span><br><span class="line"><span class="number">83f</span>42e8c  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42e90  <span class="number">83f</span>81cbc nt!CmNtCSDVersion</span><br><span class="line"><span class="number">83f</span>42e94  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42e98  <span class="number">83f</span>82668 nt!MmPhysicalMemoryBlock</span><br><span class="line"><span class="number">83f</span>42e9c  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42ea0  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42ea4  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42ea8  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42eac  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42eb0  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42eb4  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42eb8  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42ebc  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42ec0  <span class="number">00880058</span></span><br><span class="line"><span class="number">83f</span>42ec4  <span class="number">00280030</span></span><br><span class="line"><span class="number">83f</span>42ec8  <span class="number">00680050</span></span><br><span class="line"><span class="number">83f</span>42ecc  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42ed0  <span class="number">01</span>a802c0</span><br><span class="line"><span class="number">83f</span>42ed4  <span class="number">00180140</span></span><br><span class="line"><span class="number">83f</span>42ed8  <span class="number">19323628</span></span><br><span class="line"><span class="number">83f</span>42edc  <span class="number">03</span>c00004</span><br><span class="line"><span class="number">83f</span>42ee0  <span class="number">336</span>c0014</span><br><span class="line"><span class="number">83f</span>42ee4  <span class="number">03</span>cc0018</span><br><span class="line"><span class="number">83f</span>42ee8  <span class="number">000002b</span>8</span><br><span class="line"><span class="number">83f</span>42eec  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42ef0  <span class="number">84186008</span> nt!KdPrintCircularBuffer</span><br><span class="line"><span class="number">83f</span>42ef4  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42ef8  <span class="number">8418600</span>c nt!KdPrintBufferSize</span><br><span class="line"><span class="number">83f</span>42efc  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42f00  <span class="number">83f</span>7dd20 nt!KdpLoaderDebuggerBlock</span><br><span class="line"><span class="number">83f</span>42f04  ffffffff</span><br><span class="line"><span class="number">83f</span>42f08  <span class="number">001</span>c3748</span><br><span class="line"><span class="number">83f</span>42f0c  <span class="number">01200020</span></span><br><span class="line"><span class="number">83f</span>42f10  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42f14  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42f18  <span class="number">02e40000</span></span><br><span class="line"><span class="number">83f</span>42f1c  <span class="number">00100008</span></span><br><span class="line"><span class="number">83f</span>42f20  <span class="number">00180030</span></span><br><span class="line"><span class="number">83f</span>42f24  <span class="number">00380020</span></span><br><span class="line"><span class="number">83f</span>42f28  <span class="number">00280048</span></span><br><span class="line"><span class="number">83f</span>42f2c  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42f30  <span class="number">83f</span>80420 nt!IopNumTriageDumpDataBlocks</span><br><span class="line"><span class="number">83f</span>42f34  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42f38  <span class="number">83f</span>80220 nt!IopTriageDumpDataBlocks</span><br><span class="line"><span class="number">83f</span>42f3c  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42f40  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42f44  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42f48  <span class="number">83f</span>6118c nt!MmBadPagesDetected</span><br><span class="line"><span class="number">83f</span>42f4c  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42f50  <span class="number">83f</span>61188 nt!MmZeroedPageSingleBitErrorsDetected</span><br><span class="line"><span class="number">83f</span>42f54  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42f58  <span class="number">83e5</span>f088 nt!EtwpDebuggerData</span><br><span class="line"><span class="number">83f</span>42f5c  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42f60  <span class="number">00003618</span></span><br><span class="line"><span class="number">83f</span>42f64  <span class="number">00000000</span></span><br><span class="line"><span class="number">83f</span>42f68  <span class="number">83f</span>50ea8 nt!Kd_SYSTEM_Mask</span><br><span class="line"><span class="number">83f</span>42f6c  <span class="number">83f</span>50eac nt!Kd_SMSS_Mask</span><br><span class="line"><span class="number">83f</span>42f70  <span class="number">83f</span>50eb0 nt!Kd_SETUP_Mask</span><br><span class="line"><span class="number">83f</span>42f74  <span class="number">83f</span>50eb4 nt!Kd_NTFS_Mask</span><br><span class="line"><span class="number">83f</span>42f78  <span class="number">83f</span>50eb8 nt!Kd_FSTUB_Mask</span><br><span class="line"><span class="number">83f</span>42f7c  <span class="number">83f</span>50ebc nt!Kd_CRASHDUMP_Mask</span><br><span class="line"><span class="number">83f</span>42f80  <span class="number">83f</span>50ec0 nt!Kd_CDAUDIO_Mask</span><br><span class="line"><span class="number">83f</span>42f84  <span class="number">83f</span>50ec4 nt!Kd_CDROM_Mask</span><br><span class="line"><span class="number">83f</span>42f88  <span class="number">83f</span>50ec8 nt!Kd_CLASSPNP_Mask</span><br><span class="line"><span class="number">83f</span>42f8c  <span class="number">83f</span>50ecc nt!Kd_DISK_Mask</span><br><span class="line"><span class="number">83f</span>42f90  <span class="number">83f</span>50ed0 nt!Kd_REDBOOK_Mask</span><br><span class="line"><span class="number">83f</span>42f94  <span class="number">83f</span>50ed4 nt!Kd_STORPROP_Mask</span><br><span class="line"><span class="number">83f</span>42f98  <span class="number">83f</span>50ed8 nt!Kd_SCSIPORT_Mask</span><br><span class="line"><span class="number">83f</span>42f9c  <span class="number">83f</span>50edc nt!Kd_SCSIMINIPORT_Mask</span><br><span class="line"><span class="number">83f</span>42fa0  <span class="number">83f</span>50ee0 nt!Kd_CONFIG_Mask</span><br><span class="line"><span class="number">83f</span>42fa4  <span class="number">83f</span>50ee4 nt!Kd_I8042PRT_Mask</span><br><span class="line"><span class="number">83f</span>42fa8  <span class="number">83f</span>50ee8 nt!Kd_SERMOUSE_Mask</span><br><span class="line"><span class="number">83f</span>42fac  <span class="number">83f</span>50eec nt!Kd_LSERMOUS_Mask</span><br><span class="line"><span class="number">83f</span>42fb0  <span class="number">83f</span>50ef0 nt!Kd_KBDHID_Mask</span><br><span class="line"><span class="number">83f</span>42fb4  <span class="number">83f</span>50ef4 nt!Kd_MOUHID_Mask</span><br><span class="line"><span class="number">83f</span>42fb8  <span class="number">83f</span>50ef8 nt!Kd_KBDCLASS_Mask</span><br><span class="line"><span class="number">83f</span>42fbc  <span class="number">83f</span>50efc nt!Kd_MOUCLASS_Mask</span><br><span class="line"><span class="number">83f</span>42fc0  <span class="number">83f</span>50f00 nt!Kd_TWOTRACK_Mask</span><br><span class="line"><span class="number">83f</span>42fc4  <span class="number">83f</span>50f04 nt!Kd_WMILIB_Mask</span><br><span class="line"><span class="number">83f</span>42fc8  <span class="number">83f</span>50f08 nt!Kd_ACPI_Mask</span><br><span class="line"><span class="number">83f</span>42fcc  <span class="number">83f</span>50f0c nt!Kd_AMLI_Mask</span><br><span class="line"><span class="number">83f</span>42fd0  <span class="number">83f</span>50f10 nt!Kd_HALIA64_Mask</span><br><span class="line"><span class="number">83f</span>42fd4  <span class="number">83f</span>50f14 nt!Kd_VIDEO_Mask</span><br><span class="line"><span class="number">83f</span>42fd8  <span class="number">83f</span>50f18 nt!Kd_SVCHOST_Mask</span><br><span class="line"><span class="number">83f</span>42fdc  <span class="number">83f</span>50f1c nt!Kd_VIDEOPRT_Mask</span><br><span class="line"><span class="number">83f</span>42fe0  <span class="number">83f</span>50f20 nt!Kd_TCPIP_Mask</span><br><span class="line"><span class="number">83f</span>42fe4  <span class="number">83f</span>50f24 nt!Kd_DMSYNTH_Mask</span><br><span class="line"><span class="number">83f</span>42fe8  <span class="number">83f</span>50f28 nt!Kd_NTOSPNP_Mask</span><br><span class="line"><span class="number">83f</span>42fec  <span class="number">83f</span>50f2c nt!Kd_FASTFAT_Mask</span><br><span class="line"><span class="number">83f</span>42ff0  <span class="number">83f</span>50f30 nt!Kd_SAMSS_Mask</span><br><span class="line"><span class="number">83f</span>42ff4  <span class="number">83f</span>50f34 nt!Kd_PNPMGR_Mask</span><br><span class="line"><span class="number">83f</span>42ff8  <span class="number">83f</span>50f38 nt!Kd_NETAPI_Mask</span><br><span class="line"><span class="number">83f</span>42ffc  <span class="number">83f</span>50f3c nt!Kd_SCSERVER_Mask</span><br><span class="line"><span class="number">83f</span>43000  <span class="number">83f</span>50f40 nt!Kd_SCCLIENT_Mask</span><br><span class="line"><span class="number">83f</span>43004  <span class="number">83f</span>50f44 nt!Kd_SERIAL_Mask</span><br><span class="line"><span class="number">83f</span>43008  <span class="number">83f</span>50f48 nt!Kd_SERENUM_Mask</span><br><span class="line"><span class="number">83f</span>4300c  <span class="number">83f</span>50f4c nt!Kd_UHCD_Mask</span><br><span class="line"><span class="number">83f</span>43010  <span class="number">83f</span>50f50 nt!Kd_RPCPROXY_Mask</span><br><span class="line"><span class="number">83f</span>43014  <span class="number">83f</span>50f54 nt!Kd_AUTOCHK_Mask</span><br><span class="line"><span class="number">83f</span>43018  <span class="number">83f</span>50f58 nt!Kd_DCOMSS_Mask</span><br><span class="line"><span class="number">83f</span>4301c  <span class="number">83f</span>50f5c nt!Kd_UNIMODEM_Mask</span><br><span class="line"><span class="number">83f</span>43020  <span class="number">83f</span>50f60 nt!Kd_SIS_Mask</span><br><span class="line"><span class="number">83f</span>43024  <span class="number">83f</span>50f64 nt!Kd_FLTMGR_Mask</span><br></pre></td></tr></table></figure>
<h1 id="线程"><a href="#线程" class="headerlink" title="线程"></a>线程</h1><h2 id="线程查询"><a href="#线程查询" class="headerlink" title="线程查询"></a>线程查询</h2><p>XP中有32个就绪链表，其实是33个有一个在线程结构<code>_KTHREAD</code>中的+074的位置的<code>WaitListEntry</code>，0-1F这32个优先级对应这32个全局性的链表，假如一个线程的优先级为18，那么<code>WaitListEntry</code>指向的就是18号链表。</p>
<p>到了Win7和server2003等等，这32个链表就不是全局的了。他放到了KPRCB中的+3320的<code>DispatcherReadyListHead</code></p>
<p>那么如何快速找到对应的链表呢？KPRCB中定义了一个32位（四字节）的位图+13ec的<code>ReadySummary</code>，每个位由0或1代表有没有存在等待的线程，找的时候从高位开始找，找哪个位为1。</p>
<h3 id="对ntkrnlpa-exe线程查询的逆向"><a href="#对ntkrnlpa-exe线程查询的逆向" class="headerlink" title="对ntkrnlpa.exe线程查询的逆向"></a>对ntkrnlpa.exe线程查询的逆向</h3><p>这种内部调用的模块一般为<code>Ki</code>开头，加上Find，这个就是</p>
<p><img src="https://gitee.com/ZDDR/blog_img/raw/master/img/x86_kernel_ProcessAndThread/%E8%BF%99%E7%A7%8D%E5%86%85%E9%83%A8%E8%B0%83%E7%94%A8%E7%9A%84%E6%A8%A1%E5%9D%97%E4%B8%80%E8%88%AC%E4%B8%BA.png" alt="image-20201209171228316"></p>
<p><img src="https://gitee.com/ZDDR/blog_img/raw/master/img/x86_kernel_ProcessAndThread/%E7%BA%BF%E7%A8%8B%E6%9F%A5%E8%AF%A2%E7%9A%84%E9%80%86%E5%90%91.png" alt="image-20201209193302503"></p>
<p>先随便找一个进程</p>
<p><img src="https://gitee.com/ZDDR/blog_img/raw/master/img/x86_kernel_ProcessAndThread/%E5%85%88%E9%9A%8F%E4%BE%BF%E6%89%BE%E4%B8%80%E4%B8%AA%E8%BF%9B%E7%A8%8B.png" alt="image-20201208150631124"></p>
<p>直接!process 查看线程 因为这个程序比较简单 所以只有一个窗口的线程</p>
<p><img src="https://gitee.com/ZDDR/blog_img/raw/master/img/x86_kernel_ProcessAndThread/%E7%9B%B4%E6%8E%A5process%E6%9F%A5%E7%9C%8B%E7%BA%BF%E7%A8%8B.png" alt="image-20201208151457612"></p>
<h2 id="ETHREAD"><a href="#ETHREAD" class="headerlink" title="_ETHREAD"></a>_ETHREAD</h2><p>使用dt _ETHREAD 查看结构</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>: kd&gt; dt _ETHREAD <span class="number">8779e030</span></span><br><span class="line">ntdll!_ETHREAD</span><br><span class="line">   +<span class="number">0x000</span> Tcb              : _KTHREAD <span class="comment">//微内核</span></span><br><span class="line">   +<span class="number">0x200</span> CreateTime       : _LARGE_INTEGER <span class="number">0x01d6cd27</span>`be3c6bfc</span><br><span class="line">   +<span class="number">0x208</span> ExitTime         : _LARGE_INTEGER <span class="number">0x8779e238</span>`<span class="number">8779e238</span></span><br><span class="line">   +<span class="number">0x208</span> KeyedWaitChain   : _LIST_ENTRY [ <span class="number">0x8779e238</span> - <span class="number">0x8779e238</span> ] <span class="comment">//等待链</span></span><br><span class="line">   +<span class="number">0x210</span> ExitStatus       : <span class="number">0</span>n0</span><br><span class="line">   +<span class="number">0x214</span> PostBlockList    : _LIST_ENTRY [ <span class="number">0x0</span> - <span class="number">0x76fb7098</span> ]</span><br><span class="line">   +<span class="number">0x214</span> ForwardLinkShadow : (null) </span><br><span class="line">   +<span class="number">0x218</span> StartAddress     : <span class="number">0x76fb7098</span> Void	<span class="comment">//线程起始地址</span></span><br><span class="line">   +<span class="number">0x21c</span> TerminationPort  : (null) </span><br><span class="line">   +<span class="number">0x21c</span> ReaperLink       : (null) </span><br><span class="line">   +<span class="number">0x21c</span> KeyedWaitValue   : (null) </span><br><span class="line">   +<span class="number">0x220</span> ActiveTimerListLock : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x224</span> ActiveTimerListHead : _LIST_ENTRY [ <span class="number">0x8779e254</span> - <span class="number">0x8779e254</span> ] <span class="comment">//定时器链表</span></span><br><span class="line">   +<span class="number">0x22c</span> Cid              : _CLIENT_ID <span class="comment">//包含一个创建此线程的进程id和自己的线程id</span></span><br><span class="line">   +<span class="number">0x234</span> KeyedWaitSemaphore : _KSEMAPHORE</span><br><span class="line">   +<span class="number">0x234</span> AlpcWaitSemaphore : _KSEMAPHORE</span><br><span class="line">   +<span class="number">0x248</span> ClientSecurity   : _PS_CLIENT_SECURITY_CONTEXT</span><br><span class="line">   +<span class="number">0x24c</span> IrpList          : _LIST_ENTRY [ <span class="number">0x8779e27c</span> - <span class="number">0x8779e27c</span> ]</span><br><span class="line">   +<span class="number">0x254</span> TopLevelIrp      : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x258</span> DeviceToVerify   : (null) </span><br><span class="line">   +<span class="number">0x25c</span> CpuQuotaApc      : (null) </span><br><span class="line">   +<span class="number">0x260</span> Win32StartAddress : <span class="number">0x00402317</span> Void	<span class="comment">//如果是ui程序起始地址则使用这个</span></span><br><span class="line">   +<span class="number">0x264</span> LegacyPowerObject : (null) </span><br><span class="line">   +<span class="number">0x268</span> ThreadListEntry  : _LIST_ENTRY [ <span class="number">0x8775aaf8</span> - <span class="number">0x8775aaf8</span> ] <span class="comment">//线程链表</span></span><br><span class="line">   +<span class="number">0x270</span> RundownProtect   : _EX_RUNDOWN_REF</span><br><span class="line">   +<span class="number">0x274</span> ThreadLock       : _EX_PUSH_LOCK</span><br><span class="line">   +<span class="number">0x278</span> ReadClusterSize  : <span class="number">7</span></span><br><span class="line">   +<span class="number">0x27c</span> MmLockOrdering   : <span class="number">0</span>n0</span><br><span class="line">   +<span class="number">0x280</span> CrossThreadFlags : <span class="number">0xa802</span>		</span><br><span class="line">   +<span class="number">0x280</span> Terminated       : <span class="number">0</span>y0		<span class="comment">//是否已经被结束</span></span><br><span class="line">   +<span class="number">0x280</span> ThreadInserted   : <span class="number">0</span>y1		<span class="comment">//线程是否可以插入 置0被保护</span></span><br><span class="line">   +<span class="number">0x280</span> HideFromDebugger : <span class="number">0</span>y0		<span class="comment">//调试器的保护 置1普通调试器无法挂起</span></span><br><span class="line">   +<span class="number">0x280</span> ActiveImpersonationInfo : <span class="number">0</span>y0</span><br><span class="line">   +<span class="number">0x280</span> Reserved         : <span class="number">0</span>y0</span><br><span class="line">   +<span class="number">0x280</span> HardErrorsAreDisabled : <span class="number">0</span>y0</span><br><span class="line">   +<span class="number">0x280</span> BreakOnTermination : <span class="number">0</span>y0		<span class="comment">//置一线程无法被结束 结束就蓝屏</span></span><br><span class="line">   +<span class="number">0x280</span> SkipCreationMsg  : <span class="number">0</span>y0</span><br><span class="line">   +<span class="number">0x280</span> SkipTerminationMsg : <span class="number">0</span>y0</span><br><span class="line">   +<span class="number">0x280</span> CopyTokenOnOpen  : <span class="number">0</span>y0</span><br><span class="line">   +<span class="number">0x280</span> ThreadIoPriority : <span class="number">0</span>y010</span><br><span class="line">   +<span class="number">0x280</span> ThreadPagePriority : <span class="number">0</span>y101</span><br><span class="line">   +<span class="number">0x280</span> RundownFail      : <span class="number">0</span>y0</span><br><span class="line">   +<span class="number">0x280</span> NeedsWorkingSetAging : <span class="number">0</span>y0</span><br><span class="line">   +<span class="number">0x284</span> SameThreadPassiveFlags : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x284</span> ActiveExWorker   : <span class="number">0</span>y0</span><br><span class="line">   +<span class="number">0x284</span> ExWorkerCanWaitUser : <span class="number">0</span>y0</span><br><span class="line">   +<span class="number">0x284</span> MemoryMaker      : <span class="number">0</span>y0</span><br><span class="line">   +<span class="number">0x284</span> ClonedThread     : <span class="number">0</span>y0</span><br><span class="line">   +<span class="number">0x284</span> KeyedEventInUse  : <span class="number">0</span>y0</span><br><span class="line">   +<span class="number">0x284</span> RateApcState     : <span class="number">0</span>y00</span><br><span class="line">   +<span class="number">0x284</span> SelfTerminate    : <span class="number">0</span>y0</span><br><span class="line">   +<span class="number">0x288</span> SameThreadApcFlags : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x288</span> Spare            : <span class="number">0</span>y0</span><br><span class="line">   +<span class="number">0x288</span> StartAddressInvalid : <span class="number">0</span>y0</span><br><span class="line">   +<span class="number">0x288</span> EtwPageFaultCalloutActive : <span class="number">0</span>y0</span><br><span class="line">   +<span class="number">0x288</span> OwnsProcessWorkingSetExclusive : <span class="number">0</span>y0</span><br><span class="line">   +<span class="number">0x288</span> OwnsProcessWorkingSetShared : <span class="number">0</span>y0</span><br><span class="line">   +<span class="number">0x288</span> OwnsSystemCacheWorkingSetExclusive : <span class="number">0</span>y0</span><br><span class="line">   +<span class="number">0x288</span> OwnsSystemCacheWorkingSetShared : <span class="number">0</span>y0</span><br><span class="line">   +<span class="number">0x288</span> OwnsSessionWorkingSetExclusive : <span class="number">0</span>y0</span><br><span class="line">   +<span class="number">0x289</span> OwnsSessionWorkingSetShared : <span class="number">0</span>y0</span><br><span class="line">   +<span class="number">0x289</span> OwnsProcessAddressSpaceExclusive : <span class="number">0</span>y0</span><br><span class="line">   +<span class="number">0x289</span> OwnsProcessAddressSpaceShared : <span class="number">0</span>y0</span><br><span class="line">   +<span class="number">0x289</span> SuppressSymbolLoad : <span class="number">0</span>y0</span><br><span class="line">   +<span class="number">0x289</span> Prefetching      : <span class="number">0</span>y0</span><br><span class="line">   +<span class="number">0x289</span> OwnsDynamicMemoryShared : <span class="number">0</span>y0</span><br><span class="line">   +<span class="number">0x289</span> OwnsChangeControlAreaExclusive : <span class="number">0</span>y0</span><br><span class="line">   +<span class="number">0x289</span> OwnsChangeControlAreaShared : <span class="number">0</span>y0</span><br><span class="line">   +<span class="number">0x28a</span> OwnsPagedPoolWorkingSetExclusive : <span class="number">0</span>y0</span><br><span class="line">   +<span class="number">0x28a</span> OwnsPagedPoolWorkingSetShared : <span class="number">0</span>y0</span><br><span class="line">   +<span class="number">0x28a</span> OwnsSystemPtesWorkingSetExclusive : <span class="number">0</span>y0</span><br><span class="line">   +<span class="number">0x28a</span> OwnsSystemPtesWorkingSetShared : <span class="number">0</span>y0</span><br><span class="line">   +<span class="number">0x28a</span> TrimTrigger      : <span class="number">0</span>y00</span><br><span class="line">   +<span class="number">0x28a</span> Spare1           : <span class="number">0</span>y00</span><br><span class="line">   +<span class="number">0x28b</span> PriorityRegionActive : <span class="number">0</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">   +0x28c CacheManagerActive : 0 &#x27;&#x27;</span><br><span class="line">   +<span class="number">0x28d</span> DisablePageFaultClustering : <span class="number">0</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">   +0x28e ActiveFaultCount : 0 &#x27;&#x27;</span><br><span class="line">   +<span class="number">0x28f</span> LockOrderState   : <span class="number">0</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">   +0x290 AlpcMessageId    : 0</span><br><span class="line">   +<span class="number">0x294</span> AlpcMessage      : (null) </span><br><span class="line">   +<span class="number">0x294</span> AlpcReceiveAttributeSet : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x298</span> AlpcWaitListEntry : _LIST_ENTRY [ <span class="number">0x0</span> - <span class="number">0x871e19ac</span> ]</span><br><span class="line">   +<span class="number">0x2a0</span> CacheManagerCount : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x2a4</span> IoBoostCount     : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x2a8</span> IrpListLock      : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x2ac</span> ReservedForSynchTracking : (null) </span><br><span class="line">   +<span class="number">0x2b0</span> CmCallbackListHead : _SINGLE_LIST_ENTRY</span><br></pre></td></tr></table></figure>
<h3 id="KTHREAD"><a href="#KTHREAD" class="headerlink" title="_KTHREAD"></a>_KTHREAD</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>: kd&gt; dt _KTHREAD <span class="number">8779e030</span></span><br><span class="line">ntdll!_KTHREAD</span><br><span class="line">   +<span class="number">0x000</span> Header           : _DISPATCHER_HEADER		<span class="comment">//可等待头</span></span><br><span class="line">   +<span class="number">0x010</span> CycleTime        : <span class="number">0x00000008</span>`<span class="number">9136</span>cc40</span><br><span class="line">   +<span class="number">0x018</span> HighCycleTime    : <span class="number">8</span></span><br><span class="line">   +<span class="number">0x020</span> QuantumTarget    : <span class="number">0x00000008</span>`<span class="number">93</span>a685c1</span><br><span class="line">   +<span class="number">0x028</span> InitialStack     : <span class="number">0x93217ed0</span> Void		<span class="comment">//线程所属内核态的堆栈 初始化栈（栈底）</span></span><br><span class="line">   +<span class="number">0x02c</span> StackLimit       : <span class="number">0x93215000</span> Void		<span class="comment">//栈顶</span></span><br><span class="line">   +<span class="number">0x030</span> KernelStack      : <span class="number">0x93217aa0</span> Void		<span class="comment">//当前esp位置 当线程切走时 esp保存在这 回来再从赋值到esp</span></span><br><span class="line">   +<span class="number">0x034</span> ThreadLock       : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x038</span> WaitRegister     : _KWAIT_STATUS_REGISTER</span><br><span class="line">   +0x039 Running          : 0 &#x27;&#x27;					//线程是否在运行 运行为1 其他状态都为0</span><br><span class="line">   +<span class="number">0x03a</span> Alerted          : [<span class="number">2</span>]  <span class="string">&quot;&quot;</span>	<span class="comment">//警惕性 [0]内核警醒 [1]用户警醒 指该线程分别在内核模式和用户模式下是否可以被唤醒</span></span><br><span class="line">   +<span class="number">0x03c</span> KernelStackResident : <span class="number">0</span>y1</span><br><span class="line">   +<span class="number">0x03c</span> ReadyTransition  : <span class="number">0</span>y0</span><br><span class="line">   +<span class="number">0x03c</span> ProcessReadyQueue : <span class="number">0</span>y0</span><br><span class="line">   +<span class="number">0x03c</span> WaitNext         : <span class="number">0</span>y0</span><br><span class="line">   +<span class="number">0x03c</span> SystemAffinityActive : <span class="number">0</span>y0</span><br><span class="line">   +<span class="number">0x03c</span> Alertable        : <span class="number">0</span>y0		<span class="comment">//此线程是否可以被唤醒 WaitForSingkeObject</span></span><br><span class="line">   +<span class="number">0x03c</span> GdiFlushActive   : <span class="number">0</span>y0</span><br><span class="line">   +<span class="number">0x03c</span> UserStackWalkActive : <span class="number">0</span>y0</span><br><span class="line">   +<span class="number">0x03c</span> ApcInterruptRequest : <span class="number">0</span>y0</span><br><span class="line">   +<span class="number">0x03c</span> ForceDeferSchedule : <span class="number">0</span>y0</span><br><span class="line">   +<span class="number">0x03c</span> QuantumEndMigrate : <span class="number">0</span>y0</span><br><span class="line">   +<span class="number">0x03c</span> UmsDirectedSwitchEnable : <span class="number">0</span>y0</span><br><span class="line">   +<span class="number">0x03c</span> TimerActive      : <span class="number">0</span>y0</span><br><span class="line">   +<span class="number">0x03c</span> SystemThread     : <span class="number">0</span>y0		<span class="comment">//是否是系统线程 1是</span></span><br><span class="line">   +<span class="number">0x03c</span> Reserved         : <span class="number">0</span>y000000000000000000 (<span class="number">0</span>)</span><br><span class="line">   +<span class="number">0x03c</span> MiscFlags        : <span class="number">0</span>n1</span><br><span class="line">   +<span class="number">0x040</span> ApcState         : _KAPC_STATE	<span class="comment">//apc状态 此结构里也有一个进程 为挂靠的进程</span></span><br><span class="line">   +<span class="number">0x040</span> ApcStateFill     : [<span class="number">23</span>]  <span class="string">&quot;p???&quot;</span></span><br><span class="line">   +0x057 Priority         : 13 &#x27;&#x27;		//线程的优先级</span><br><span class="line">   +<span class="number">0x058</span> NextProcessor    : <span class="number">1</span>			<span class="comment">//下个处理器 如果为0随机选择处理器运行线程 如果有值则是对应值的核</span></span><br><span class="line">   +<span class="number">0x05c</span> DeferredProcessor : <span class="number">0</span>			<span class="comment">//默认处理器</span></span><br><span class="line">   +<span class="number">0x060</span> ApcQueueLock     : <span class="number">0</span>			<span class="comment">//apc队列锁</span></span><br><span class="line">   +<span class="number">0x064</span> ContextSwitches  : <span class="number">0x1313d</span>	<span class="comment">//ContextSwitches域记录了该线程进行了多少次环境切换</span></span><br><span class="line">   +<span class="number">0x068</span> State            : <span class="number">0x5</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">   +0x069 NpxState         : 0 &#x27;&#x27;		//浮点协处理器的状态</span><br><span class="line">   +0x06a WaitIrql         : 0 &#x27;&#x27;		//等待的RIQL等级</span><br><span class="line">   +0x06b WaitMode         : 1 &#x27;&#x27;		//等待的模式 0环或3环</span><br><span class="line">   +<span class="number">0x06c</span> WaitStatus       : <span class="number">0</span>n0		<span class="comment">//等待的结果状态</span></span><br><span class="line">   +<span class="number">0x070</span> WaitBlockList    : <span class="number">0x8779e0f0</span> _KWAIT_BLOCK</span><br><span class="line">   +<span class="number">0x074</span> WaitListEntry    : _LIST_ENTRY [ <span class="number">0x807d6300</span> - <span class="number">0x86a140a4</span> ]</span><br><span class="line">   +<span class="number">0x074</span> SwapListEntry    : _SINGLE_LIST_ENTRY</span><br><span class="line">   +<span class="number">0x07c</span> Queue            : (null) 	<span class="comment">//队列</span></span><br><span class="line">   +<span class="number">0x080</span> WaitTime         : <span class="number">0x625d3</span>	<span class="comment">//等待的时间</span></span><br><span class="line">   +<span class="number">0x084</span> KernelApcDisable : <span class="number">0</span>n0</span><br><span class="line">   +<span class="number">0x086</span> SpecialApcDisable : <span class="number">0</span>n0</span><br><span class="line">   +<span class="number">0x084</span> CombinedApcDisable : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x088</span> Teb              : <span class="number">0x7ffdf000</span> Void		<span class="comment">//线程的TEB</span></span><br><span class="line">   +<span class="number">0x090</span> Timer            : _KTIMER				<span class="comment">//线程的定时器</span></span><br><span class="line">   +<span class="number">0x0b8</span> AutoAlignment    : <span class="number">0</span>y0				</span><br><span class="line">   +<span class="number">0x0b8</span> DisableBoost     : <span class="number">0</span>y0</span><br><span class="line">   +<span class="number">0x0b8</span> EtwStackTraceApc1Inserted : <span class="number">0</span>y0</span><br><span class="line">   +<span class="number">0x0b8</span> EtwStackTraceApc2Inserted : <span class="number">0</span>y0</span><br><span class="line">   +<span class="number">0x0b8</span> CalloutActive    : <span class="number">0</span>y0					<span class="comment">//判断是否正在0环调3环 如果是为1 KrUSermodecallback</span></span><br><span class="line">   +<span class="number">0x0b8</span> ApcQueueable     : <span class="number">0</span>y1					<span class="comment">//apc队列是否可以使用</span></span><br><span class="line">   +<span class="number">0x0b8</span> EnableStackSwap  : <span class="number">0</span>y1</span><br><span class="line">   +<span class="number">0x0b8</span> GuiThread        : <span class="number">0</span>y0					<span class="comment">//是否是gui线程</span></span><br><span class="line">   +<span class="number">0x0b8</span> UmsPerformingSyscall : <span class="number">0</span>y0</span><br><span class="line">   +<span class="number">0x0b8</span> VdmSafe          : <span class="number">0</span>y0</span><br><span class="line">   +<span class="number">0x0b8</span> UmsDispatched    : <span class="number">0</span>y0</span><br><span class="line">   +<span class="number">0x0b8</span> ReservedFlags    : <span class="number">0</span>y000000000000000000000 (<span class="number">0</span>)</span><br><span class="line">   +<span class="number">0x0b8</span> ThreadFlags      : <span class="number">0</span>n96</span><br><span class="line">   +<span class="number">0x0bc</span> ServiceTable     : <span class="number">0x83f84a00</span> Void		<span class="comment">//服务表</span></span><br><span class="line">   +<span class="number">0x0c0</span> WaitBlock        : [<span class="number">4</span>] _KWAIT_BLOCK</span><br><span class="line">   +<span class="number">0x120</span> QueueListEntry   : _LIST_ENTRY [ <span class="number">0x0</span> - <span class="number">0x0</span> ]</span><br><span class="line">   +<span class="number">0x128</span> TrapFrame        : <span class="number">0x93217c34</span> _KTRAP_FRAME</span><br><span class="line">   +<span class="number">0x12c</span> FirstArgument    : <span class="number">0x0012ff00</span> Void		<span class="comment">//TrapFrame</span></span><br><span class="line">   +<span class="number">0x130</span> CallbackStack    : (null) </span><br><span class="line">   +<span class="number">0x130</span> CallbackDepth    : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x134</span> ApcStateIndex    : <span class="number">0</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">   +0x135 BasePriority     : 8 &#x27;&#x27;					//来自进程优先级的继承</span><br><span class="line">   +0x136 PriorityDecrement : 18 &#x27;&#x27;					//优先级调整值</span><br><span class="line">   +<span class="number">0x136</span> ForegroundBoost  : <span class="number">0</span>y0010</span><br><span class="line">   +<span class="number">0x136</span> UnusualBoost     : <span class="number">0</span>y0001</span><br><span class="line">   +0x137 Preempted        : 0 &#x27;&#x27;					//抢占</span><br><span class="line">   +<span class="number">0x138</span> AdjustReason     : <span class="number">0</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">   +0x139 AdjustIncrement  : 2 &#x27;&#x27;</span><br><span class="line">   +0x13a PreviousMode     : 1 &#x27;&#x27;					//先前模式</span><br><span class="line">   +<span class="number">0x13b</span> Saturation       : <span class="number">0</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">   +0x13c SystemCallNumber : 0x1273</span><br><span class="line">   +<span class="number">0x140</span> FreezeCount      : <span class="number">0</span>						<span class="comment">//被挂起的次数 反调试能用到</span></span><br><span class="line">   +<span class="number">0x144</span> UserAffinity     : _GROUP_AFFINITY</span><br><span class="line">   +<span class="number">0x150</span> Process          : <span class="number">0x8775a970</span> _KPROCESS	<span class="comment">//创建这个线程的进程</span></span><br><span class="line">   +<span class="number">0x154</span> Affinity         : _GROUP_AFFINITY</span><br><span class="line">   +<span class="number">0x160</span> IdealProcessor   : <span class="number">1</span></span><br><span class="line">   +<span class="number">0x164</span> UserIdealProcessor : <span class="number">1</span></span><br><span class="line">   +<span class="number">0x168</span> ApcStatePointer  : [<span class="number">2</span>] <span class="number">0x8779e070</span> _KAPC_STATE</span><br><span class="line">   +<span class="number">0x170</span> SavedApcState    : _KAPC_STATE</span><br><span class="line">   +<span class="number">0x170</span> SavedApcStateFill : [<span class="number">23</span>]  <span class="string">&quot;???&quot;</span></span><br><span class="line">   +<span class="number">0x187</span> WaitReason       : <span class="number">0xd</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">   +0x188 SuspendCount     : 0 &#x27;&#x27;</span><br><span class="line">   +<span class="number">0x189</span> Spare1           : <span class="number">0</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">   +0x18a OtherPlatformFill : 0 &#x27;&#x27;</span><br><span class="line">   +<span class="number">0x18c</span> Win32Thread      : <span class="number">0xfe9345a8</span> Void</span><br><span class="line">   +<span class="number">0x190</span> StackBase        : <span class="number">0x93218000</span> Void</span><br><span class="line">   +<span class="number">0x194</span> SuspendApc       : _KAPC</span><br><span class="line">   +<span class="number">0x194</span> SuspendApcFill0  : [<span class="number">1</span>]  <span class="string">&quot;??????&quot;</span></span><br><span class="line">   +<span class="number">0x195</span> ResourceIndex    : <span class="number">0x1</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">   +0x194 SuspendApcFill1  : [3]  &quot;???&quot;</span><br><span class="line">   +<span class="number">0x197</span> QuantumReset     : <span class="number">0x12</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">   +0x194 SuspendApcFill2  : [4]  &quot;???&quot;</span><br><span class="line">   +<span class="number">0x198</span> KernelTime       : <span class="number">2</span></span><br><span class="line">   +<span class="number">0x194</span> SuspendApcFill3  : [<span class="number">36</span>]  <span class="string">&quot;???&quot;</span></span><br><span class="line">   +<span class="number">0x1b8</span> WaitPrcb         : <span class="number">0x807d3120</span> _KPRCB</span><br><span class="line">   +<span class="number">0x194</span> SuspendApcFill4  : [<span class="number">40</span>]  <span class="string">&quot;???&quot;</span></span><br><span class="line">   +<span class="number">0x1bc</span> LegoData         : (null) </span><br><span class="line">   +<span class="number">0x194</span> SuspendApcFill5  : [<span class="number">47</span>]  <span class="string">&quot;???&quot;</span> 		<span class="comment">//可用来通信</span></span><br><span class="line">   +<span class="number">0x1c3</span> LargeStack       : <span class="number">0</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">   +0x1c4 UserTime         : 2</span><br><span class="line">   +<span class="number">0x1c8</span> SuspendSemaphore : _KSEMAPHORE</span><br><span class="line">   +<span class="number">0x1c8</span> SuspendSemaphorefill : [<span class="number">20</span>]  <span class="string">&quot;???&quot;</span></span><br><span class="line">   +<span class="number">0x1dc</span> SListFaultCount  : <span class="number">0</span></span><br><span class="line">   +<span class="number">0x1e0</span> ThreadListEntry  : _LIST_ENTRY [ <span class="number">0x8775a99c</span> - <span class="number">0x8775a99c</span> ]</span><br><span class="line">   +<span class="number">0x1e8</span> MutantListHead   : _LIST_ENTRY [ <span class="number">0x8779e218</span> - <span class="number">0x8779e218</span> ]</span><br><span class="line">   +<span class="number">0x1f0</span> SListFaultAddress : (null) </span><br><span class="line">   +<span class="number">0x1f4</span> ThreadCounters   : (null) </span><br><span class="line">   +<span class="number">0x1f8</span> XStateSave       : (null) </span><br></pre></td></tr></table></figure>
<h1 id="References"><a href="#References" class="headerlink" title="References:"></a>References:</h1><blockquote>
<p>《牛逼的火哥》</p>
</blockquote>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/findumars/p/6271546.html">以及 朝闻道 大佬的博客</a></p>
</blockquote>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">ZDDR</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://zddr.net/2020/12/01/x86%E5%86%85%E6%A0%B8-%E8%BF%9B%E7%A8%8B%E7%BA%BF%E7%A8%8B(%E7%83%82%E5%B0%BE%E4%B8%AD%E3%80%82%E3%80%82)/">https://zddr.net/2020/12/01/x86内核-进程线程(烂尾中。。)/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://zddr.net" target="_blank">ZDDR's blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://s2.ax1x.com/2020/02/11/1oFBM8.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2020/12/15/x86%E5%86%85%E6%A0%B8-%E5%8F%A5%E6%9F%84/"><img class="prev-cover" src="https://s2.ax1x.com/2020/02/11/1oFBM8.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">x86内核-句柄</div></div></a></div><div class="next-post pull-right"><a href="/2020/11/25/x86%E5%86%85%E6%A0%B8-%E7%B3%BB%E7%BB%9F%E8%B0%83%E7%94%A8/"><img class="next-cover" src="https://s2.ax1x.com/2020/02/11/1oFBM8.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">x86内核-系统调用</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E8%BF%9B%E7%A8%8B"><span class="toc-number">1.</span> <span class="toc-text">什么是进程</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%9B%E7%A8%8B%E7%9A%84%E7%BB%93%E6%9E%84"><span class="toc-number">1.1.</span> <span class="toc-text">进程的结构</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%A7%E8%A1%8C%E4%BD%93%E7%BB%93%E6%9E%84"><span class="toc-number">1.1.1.</span> <span class="toc-text">执行体结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BE%AE%E5%86%85%E6%A0%B8%E7%BB%93%E6%9E%84"><span class="toc-number">1.1.2.</span> <span class="toc-text">微内核结构</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#DISPATCHER-HEADER%E6%88%90%E5%91%98%EF%BC%888%E5%AD%97%E8%8A%82%EF%BC%89"><span class="toc-number">1.1.2.1.</span> <span class="toc-text">_DISPATCHER_HEADER成员（8字节）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#KEXECUTE-OPTIONS%E6%88%90%E5%91%98"><span class="toc-number">1.1.2.2.</span> <span class="toc-text">_KEXECUTE_OPTIONS成员</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#KPCR"><span class="toc-number">2.</span> <span class="toc-text">KPCR</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#KPRCB"><span class="toc-number">2.1.</span> <span class="toc-text">KPRCB</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DBGKD-GET-VERSION64"><span class="toc-number">2.2.</span> <span class="toc-text">DBGKD_GET_VERSION64</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BA%BF%E7%A8%8B"><span class="toc-number">3.</span> <span class="toc-text">线程</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BA%BF%E7%A8%8B%E6%9F%A5%E8%AF%A2"><span class="toc-number">3.1.</span> <span class="toc-text">线程查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%B9ntkrnlpa-exe%E7%BA%BF%E7%A8%8B%E6%9F%A5%E8%AF%A2%E7%9A%84%E9%80%86%E5%90%91"><span class="toc-number">3.1.1.</span> <span class="toc-text">对ntkrnlpa.exe线程查询的逆向</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ETHREAD"><span class="toc-number">3.2.</span> <span class="toc-text">_ETHREAD</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#KTHREAD"><span class="toc-number">3.2.1.</span> <span class="toc-text">_KTHREAD</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#References"><span class="toc-number">4.</span> <span class="toc-text">References:</span></a></li></ol></div></div></div></div></main><footer id="footer" style="background-image: url(https://s2.ax1x.com/2020/02/11/1oFBM8.png)"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2021 By ZDDR</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',()=> {preloader.endLoading()})</script><div class="js-pjax"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></div></body></html>